import matplotlib.pyplot as plt
import matplotlib.cm as cm
import matplotlib as mpl
import numpy as np
import matplotlib.ticker as ticker
import matplotlib
matplotlib.rcParams['mathtext.fontset'] = 'stix'
matplotlib.rcParams['mathtext.rm'] = 'Bitstream Vera Sans'
matplotlib.rcParams['mathtext.it'] = 'Bitstream Vera Sans:italic'
matplotlib.rcParams['mathtext.bf'] = 'Bitstream Vera Sans:bold'

# boxsize=150
# phi_array = np.array([0.0005*4**j for j in range(5)])
# N_array = phi_array*(boxsize/0.5)**3/(4./3.*np.pi)

phi=0.08
ar=1./150.

sigma_ratio_array=np.array([[17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ]])

eta_array=np.array([[ 0.2       ,  0.26666667,  0.33333333,  0.4       ,  0.46666667,
   0.53333333,  0.6       ,  0.66666667,  0.73333333,  0.8       ,
   0.86666667,  0.93333333,  1.        ,  1.06666667,  1.13333333,
   1.2       ,  1.26666667,  1.33333333,  1.4       ,  1.46666667,
   1.53333333,  1.6       ,  1.66666667,  1.73333333,  1.76      ,
   1.76      ,  1.76      ,  1.76      ,  1.76      ,  1.76      ],
 [ 0.4       ,  0.53333333,  0.66666667,  0.8       ,  0.93333333,
   1.06666667,  1.2       ,  1.33333333,  1.46666667,  1.6       ,
   1.73333333,  1.86666667,  2.        ,  2.13333333,  2.26666667,
   2.4       ,  2.53333333,  2.66666667,  2.8       ,  2.93333333,
   3.06666667,  3.2       ,  3.33333333,  3.46666667,  3.52      ,
   3.52      ,  3.52      ,  3.52      ,  3.52      ,  3.52      ],
 [ 0.6       ,  0.8       ,  1.        ,  1.2       ,  1.4       ,
   1.6       ,  1.8       ,  2.        ,  2.2       ,  2.4       ,
   2.6       ,  2.8       ,  3.        ,  3.2       ,  3.4       ,
   3.6       ,  3.8       ,  4.        ,  4.2       ,  4.4       ,
   4.6       ,  4.8       ,  5.        ,  5.2       ,  5.28      ,
   5.28      ,  5.28      ,  5.28      ,  5.28      ,  5.28      ],
 [ 0.8       ,  1.06666667,  1.33333333,  1.6       ,  1.86666667,
   2.13333333,  2.4       ,  2.66666667,  2.93333333,  3.2       ,
   3.46666667,  3.73333333,  4.        ,  4.26666667,  4.53333333,
   4.8       ,  5.06666667,  5.33333333,  5.6       ,  5.86666667,
   6.13333333,  6.4       ,  6.66666667,  6.93333333,  7.04      ,
   7.04      ,  7.04      ,  7.04      ,  7.04      ,  7.04      ],
 [ 1.        ,  1.33333333,  1.66666667,  2.        ,  2.33333333,
   2.66666667,  3.        ,  3.33333333,  3.66666667,  4.        ,
   4.33333333,  4.66666667,  5.        ,  5.33333333,  5.66666667,
   6.        ,  6.33333333,  6.66666667,  7.        ,  7.33333333,
   7.66666667,  8.        ,  8.33333333,  8.66666667,  8.8       ,
   8.8       ,  8.8       ,  8.8       ,  8.8       ,  8.8       ],
 [ 1.2       ,  1.6       ,  2.        ,  2.4       ,  2.8       ,
   3.2       ,  3.6       ,  4.        ,  4.4       ,  4.8       ,
   5.2       ,  5.6       ,  6.        ,  6.4       ,  6.8       ,
   7.2       ,  7.6       ,  8.        ,  8.4       ,  8.8       ,
   9.2       ,  9.6       , 10.        , 10.4       , 10.56      ,
  10.56      , 10.56      , 10.56      , 10.56      , 10.56      ],
 [ 1.4       ,  1.86666667,  2.33333333,  2.8       ,  3.26666667,
   3.73333333,  4.2       ,  4.66666667,  5.13333333,  5.6       ,
   6.06666667,  6.53333333,  7.        ,  7.46666667,  7.93333333,
   8.4       ,  8.86666667,  9.33333333,  9.8       , 10.26666667,
  10.73333333, 11.2       , 11.66666667, 12.13333333, 12.32      ,
  12.32      , 12.32      , 12.32      , 12.32      , 12.32      ],
 [ 1.6       ,  2.13333333,  2.66666667,  3.2       ,  3.73333333,
   4.26666667,  4.8       ,  5.33333333,  5.86666667,  6.4       ,
   6.93333333,  7.46666667,  8.        ,  8.53333333,  9.06666667,
   9.6       , 10.13333333, 10.66666667, 11.2       , 11.73333333,
  12.26666667, 12.8       , 13.33333333, 13.86666667, 14.08      ,
  14.08      , 14.08      , 14.08      , 14.08      , 14.08      ],
 [ 1.8       ,  2.4       ,  3.        ,  3.6       ,  4.2       ,
   4.8       ,  5.4       ,  6.        ,  6.6       ,  7.2       ,
   7.8       ,  8.4       ,  9.        ,  9.6       , 10.2       ,
  10.8       , 11.4       , 12.        , 12.6       , 13.2       ,
  13.8       , 14.4       , 15.        , 15.6       , 15.84      ,
  15.84      , 15.84      , 15.84      , 15.84      , 15.84      ],
 [ 2.        ,  2.66666667,  3.33333333,  4.        ,  4.66666667,
   5.33333333,  6.        ,  6.66666667,  7.33333333,  8.        ,
   8.66666667,  9.33333333, 10.        , 10.66666667, 11.33333333,
  12.        , 12.66666667, 13.33333333, 14.        , 14.66666667,
  15.33333333, 16.        , 16.66666667, 17.33333333, 17.6       ,
  17.6       , 17.6       , 17.6       , 17.6       , 17.6       ],
 [ 2.2       ,  2.93333333,  3.66666667,  4.4       ,  5.13333333,
   5.86666667,  6.6       ,  7.33333333,  8.06666667,  8.8       ,
   9.53333333, 10.26666667, 11.        , 11.73333333, 12.46666667,
  13.2       , 13.93333333, 14.66666667, 15.4       , 16.13333333,
  16.86666667, 17.6       , 18.33333333, 19.06666667, 19.36      ,
  19.36      , 19.36      , 19.36      , 19.36      , 19.36      ],
 [ 2.4       ,  3.2       ,  4.        ,  4.8       ,  5.6       ,
   6.4       ,  7.2       ,  8.        ,  8.8       ,  9.6       ,
  10.4       , 11.2       , 12.        , 12.8       , 13.6       ,
  14.4       , 15.2       , 16.        , 16.8       , 17.6       ,
  18.4       , 19.2       , 20.        , 20.8       , 21.12      ,
  21.12      , 21.12      , 21.12      , 21.12      , 21.12      ],
 [ 2.6       ,  3.46666667,  4.33333333,  5.2       ,  6.06666667,
   6.93333333,  7.8       ,  8.66666667,  9.53333333, 10.4       ,
  11.26666667, 12.13333333, 13.        , 13.86666667, 14.73333333,
  15.6       , 16.46666667, 17.33333333, 18.2       , 19.06666667,
  19.93333333, 20.8       , 21.66666667, 22.53333333, 22.88      ,
  22.88      , 22.88      , 22.88      , 22.88      , 22.88      ],
 [ 2.8       ,  3.73333333,  4.66666667,  5.6       ,  6.53333333,
   7.46666667,  8.4       ,  9.33333333, 10.26666667, 11.2       ,
  12.13333333, 13.06666667, 14.        , 14.93333333, 15.86666667,
  16.8       , 17.73333333, 18.66666667, 19.6       , 20.53333333,
  21.46666667, 22.4       , 23.33333333, 24.26666667, 24.64      ,
  24.64      , 24.64      , 24.64      , 24.64      , 24.64      ],
 [ 3.        ,  4.        ,  5.        ,  6.        ,  7.        ,
   8.        ,  9.        , 10.        , 11.        , 12.        ,
  13.        , 14.        , 15.        , 16.        , 17.        ,
  18.        , 19.        , 20.        , 21.        , 22.        ,
  23.        , 24.        , 25.        , 26.        , 26.4       ,
  26.4       , 26.4       , 26.4       , 26.4       , 26.4       ],
 [ 3.2       ,  4.26666667,  5.33333333,  6.4       ,  7.46666667,
   8.53333333,  9.6       , 10.66666667, 11.73333333, 12.8       ,
  13.86666667, 14.93333333, 16.        , 17.06666667, 18.13333333,
  19.2       , 20.26666667, 21.33333333, 22.4       , 23.46666667,
  24.53333333, 25.6       , 26.66666667, 27.73333333, 28.16      ,
  28.16      , 28.16      , 28.16      , 28.16      , 28.16      ],
 [ 3.4       ,  4.53333333,  5.66666667,  6.8       ,  7.93333333,
   9.06666667, 10.2       , 11.33333333, 12.46666667, 13.6       ,
  14.73333333, 15.86666667, 17.        , 18.13333333, 19.26666667,
  20.4       , 21.53333333, 22.66666667, 23.8       , 24.93333333,
  26.06666667, 27.2       , 28.33333333, 29.46666667, 29.92      ,
  29.92      , 29.92      , 29.92      , 29.92      , 29.92      ],
 [ 3.6       ,  4.8       ,  6.        ,  7.2       ,  8.4       ,
   9.6       , 10.8       , 12.        , 13.2       , 14.4       ,
  15.6       , 16.8       , 18.        , 19.2       , 20.4       ,
  21.6       , 22.8       , 24.        , 25.2       , 26.4       ,
  27.6       , 28.8       , 30.        , 31.2       , 31.68      ,
  31.68      , 31.68      , 31.68      , 31.68      , 31.68      ],
 [ 3.8       ,  5.06666667,  6.33333333,  7.6       ,  8.86666667,
  10.13333333, 11.4       , 12.66666667, 13.93333333, 15.2       ,
  16.46666667, 17.73333333, 19.        , 20.26666667, 21.53333333,
  22.8       , 24.06666667, 25.33333333, 26.6       , 27.86666667,
  29.13333333, 30.4       , 31.66666667, 32.93333333, 33.44      ,
  33.44      , 33.44      , 33.44      , 33.44      , 33.44      ],
 [ 4.        ,  5.33333333,  6.66666667,  8.        ,  9.33333333,
  10.66666667, 12.        , 13.33333333, 14.66666667, 16.        ,
  17.33333333, 18.66666667, 20.        , 21.33333333, 22.66666667,
  24.        , 25.33333333, 26.66666667, 28.        , 29.33333333,
  30.66666667, 32.        , 33.33333333, 34.66666667, 35.2       ,
  35.2       , 35.2       , 35.2       , 35.2       , 35.2       ],
 [ 4.2       ,  5.6       ,  7.        ,  8.4       ,  9.8       ,
  11.2       , 12.6       , 14.        , 15.4       , 16.8       ,
  18.2       , 19.6       , 21.        , 22.4       , 23.8       ,
  25.2       , 26.6       , 28.        , 29.4       , 30.8       ,
  32.2       , 33.6       , 35.        , 36.4       , 36.96      ,
  36.96      , 36.96      , 36.96      , 36.96      , 36.96      ],
 [ 4.4       ,  5.86666667,  7.33333333,  8.8       , 10.26666667,
  11.73333333, 13.2       , 14.66666667, 16.13333333, 17.6       ,
  19.06666667, 20.53333333, 22.        , 23.46666667, 24.93333333,
  26.4       , 27.86666667, 29.33333333, 30.8       , 32.26666667,
  33.73333333, 35.2       , 36.66666667, 38.13333333, 38.72      ,
  38.72      , 38.72      , 38.72      , 38.72      , 38.72      ],
 [ 4.6       ,  6.13333333,  7.66666667,  9.2       , 10.73333333,
  12.26666667, 13.8       , 15.33333333, 16.86666667, 18.4       ,
  19.93333333, 21.46666667, 23.        , 24.53333333, 26.06666667,
  27.6       , 29.13333333, 30.66666667, 32.2       , 33.73333333,
  35.26666667, 36.8       , 38.33333333, 39.86666667, 40.48      ,
  40.48      , 40.48      , 40.48      , 40.48      , 40.48      ]])

error_array=np.array([[1.05200757e-01, 8.33286005e-02, 6.80940995e-02, 5.67090009e-02,
  4.78341249e-02, 4.07453314e-02, 3.50328424e-02, 3.03700402e-02,
  2.65154876e-02, 2.32764951e-02, 2.04952221e-02, 1.80560864e-02,
  1.58826710e-02, 1.39269047e-02, 1.21599123e-02, 1.05607002e-02,
  9.11231568e-03, 7.80166498e-03, 6.62049252e-03, 5.56388960e-03,
  4.62762041e-03, 3.80717292e-03, 3.09727572e-03, 2.49171891e-03,
  2.27696663e-03, 2.27696663e-03, 2.27696663e-03, 2.27696663e-03,
  2.27696663e-03, 2.27696663e-03],
 [8.91560418e-02, 6.70029521e-02, 5.22759926e-02, 4.19418660e-02,
  3.43166637e-02, 2.84797347e-02, 2.38626708e-02, 2.00934716e-02,
  1.69282422e-02, 1.41998655e-02, 1.18029243e-02, 9.67821990e-03,
  7.80352930e-03, 6.17510817e-03, 4.79211489e-03, 3.64744670e-03,
  2.72496087e-03, 2.00052178e-03, 1.44603529e-03, 1.03253337e-03,
  7.31531027e-04, 5.17518579e-04, 3.68206831e-04, 2.64788276e-04,
  2.32759688e-04, 2.32759688e-04, 2.32759688e-04, 2.32759688e-04,
  2.32759688e-04, 2.32759688e-04],
 [7.40120903e-02, 5.28253353e-02, 3.96431623e-02, 3.07584439e-02,
  2.42075594e-02, 1.90225779e-02, 1.47485042e-02, 1.12063536e-02,
  8.32189252e-03, 6.03285611e-03, 4.26557868e-03, 2.93273702e-03,
  1.95328334e-03, 1.25408841e-03, 7.72986797e-04, 4.57613693e-04,
  2.64140736e-04, 1.55666701e-04, 1.00826881e-04, 7.29453209e-05,
  5.51767115e-05, 4.11126408e-05, 2.94645969e-05, 2.02007022e-05,
  1.71570714e-05, 1.71570714e-05, 1.71570714e-05, 1.71570714e-05,
  1.71570714e-05, 1.71570714e-05],
 [6.49757897e-02, 4.51186225e-02, 3.30689203e-02, 2.47435254e-02,
  1.84067607e-02, 1.33513032e-02, 9.29691966e-03, 6.13103729e-03,
  3.78365585e-03, 2.15811785e-03, 1.12214832e-03, 5.27619305e-04,
  2.38518777e-04, 1.37205970e-04, 1.05077639e-04, 7.99657048e-05,
  5.54005368e-05, 3.50598615e-05, 2.05270625e-05, 1.12294999e-05,
  5.77933756e-06, 2.81121023e-06, 1.29664464e-06, 5.68426213e-07,
  4.03095116e-07, 4.03095116e-07, 4.03095116e-07, 4.03095116e-07,
  4.03095116e-07, 4.03095116e-07],
 [5.24246255e-02, 3.50090121e-02, 2.39780549e-02, 1.58443518e-02,
  9.73725948e-03, 5.43968192e-03, 2.70247045e-03, 1.15999594e-03,
  4.22610432e-04, 1.68896013e-04, 1.17809156e-04, 8.46576417e-05,
  5.19562757e-05, 2.78754806e-05, 1.34084826e-05, 5.87518678e-06,
  2.36808817e-06, 8.83589945e-07, 3.06451168e-07, 9.90643790e-08,
  2.99077965e-08, 8.44450131e-09, 2.23228763e-09, 5.52945483e-10,
  3.10749376e-10, 3.10749376e-10, 3.10749375e-10, 3.10749375e-10,
  3.10749374e-10, 3.10749376e-10],
 [4.42167196e-02, 2.78060347e-02, 1.69467858e-02, 9.40652798e-03,
  4.58676278e-03, 1.90174577e-03, 6.41097796e-04, 1.96836789e-04,
  1.17302554e-04, 8.09695383e-05, 4.51969168e-05, 2.11572247e-05,
  8.59844634e-06, 3.09266933e-06, 9.95099193e-07, 2.88287566e-07,
  7.55226224e-08, 1.79455567e-08, 3.87661144e-09, 7.62638169e-10,
  1.36816190e-10, 2.24070240e-11, 3.35311501e-12, 4.58820561e-13,
  2.01983834e-13, 2.01984962e-13, 2.01984327e-13, 2.01983146e-13,
  2.01984323e-13, 2.01983859e-13],
 [3.72478153e-02, 2.12067194e-02, 1.07537822e-02, 4.50895144e-03,
  1.44703324e-03, 3.26088832e-04, 1.42569576e-04, 9.70756513e-05,
  4.68428721e-05, 1.76579408e-05, 5.52890647e-06, 1.48352896e-06,
  3.47314587e-07, 7.17152947e-08, 1.31467199e-08, 2.14743312e-09,
  3.12995823e-10, 4.07099740e-11, 4.72290608e-12, 4.88455899e-13,
  4.50173026e-14, 3.72740598e-15, 4.26614832e-16, 3.17099779e-16,
  3.86664205e-16, 3.80848913e-16, 3.83446922e-16, 3.95991866e-16,
  3.79475340e-16, 3.83588512e-16],
 [3.20599042e-02, 1.62658612e-02, 6.83735841e-03, 2.17900468e-03,
  4.65731618e-04, 1.46659463e-04, 9.78295366e-05, 4.34159666e-05,
  1.42397947e-05, 3.70015779e-06, 7.86804141e-07, 1.39356398e-07,
  2.07884273e-08, 2.63111587e-09, 2.83936661e-10, 2.62139479e-11,
  2.07535698e-12, 1.41133317e-13, 8.27193165e-15, 5.60184124e-16,
  2.94182220e-16, 2.86221723e-16, 2.84011642e-16, 3.19012238e-16,
  3.78092709e-16, 3.79064409e-16, 3.79827393e-16, 3.84314159e-16,
  3.78368545e-16, 3.77403497e-16],
 [2.76345193e-02, 1.21702033e-02, 4.00001452e-03, 8.25038046e-04,
  1.65093021e-04, 1.13704741e-04, 4.52420129e-05, 1.22924094e-05,
  2.51098295e-06, 4.01341738e-07, 5.12256907e-08, 5.28479458e-09,
  4.44190276e-10, 3.05855391e-11, 1.73218332e-12, 8.09347630e-14,
  3.14199028e-15, 3.37964518e-16, 3.49201580e-16, 3.28338329e-16,
  2.87314209e-16, 2.85023498e-16, 2.80435089e-16, 3.08736313e-16,
  3.83408311e-16, 3.75265357e-16, 3.74464742e-16, 3.78062970e-16,
  3.77906384e-16, 3.77845872e-16],
 [2.17365335e-02, 7.46782378e-03, 1.62808505e-03, 2.16169364e-04,
  1.25444073e-04, 4.67373595e-05, 1.10145457e-05, 1.86413778e-06,
  2.37971750e-07, 2.34211708e-08, 1.79616233e-09, 1.07914949e-10,
  5.09460633e-12, 1.89369365e-13, 5.56141014e-15, 4.63095898e-16,
  3.63160196e-16, 3.15581741e-16, 3.47700220e-16, 3.26198047e-16,
  2.84180764e-16, 2.83414083e-16, 2.74484926e-16, 3.10979751e-16,
  3.78116376e-16, 3.83638171e-16, 3.79146754e-16, 3.75898830e-16,
  3.74774039e-16, 3.76411776e-16],
 [1.77110944e-02, 4.79532041e-03, 6.64089962e-04, 1.65064417e-04,
  7.51549418e-05, 1.74124838e-05, 2.60509007e-06, 2.72598043e-07,
  2.06311009e-08, 1.14895132e-09, 4.75279025e-11, 1.46923963e-12,
  3.40789357e-14, 7.32396896e-16, 3.55780217e-16, 4.32764744e-16,
  3.55817720e-16, 3.11474789e-16, 3.39492029e-16, 3.18223265e-16,
  2.77286944e-16, 2.77585428e-16, 2.73318985e-16, 3.06845613e-16,
  3.76929367e-16, 3.74600932e-16, 3.80569580e-16, 3.82151388e-16,
  3.77196714e-16, 3.75600982e-16],
 [1.35935002e-02, 2.66073276e-03, 2.38797011e-04, 1.24801993e-04,
  3.24185687e-05, 4.69744971e-06, 4.38054846e-07, 2.76216838e-08,
  1.20429827e-09, 3.67742845e-11, 7.93334234e-13, 1.21728889e-14,
  4.54489561e-16, 3.86203018e-16, 3.61715737e-16, 4.33281957e-16,
  3.53573038e-16, 3.08734124e-16, 3.42634281e-16, 3.19079345e-16,
  2.77173197e-16, 2.76197752e-16, 2.74458555e-16, 3.06375460e-16,
  3.77097286e-16, 3.73573101e-16, 3.75888908e-16, 3.76812083e-16,
  3.75200819e-16, 3.74709739e-16],
 [1.03606511e-02, 1.42290156e-03, 1.86701146e-04, 7.75112981e-05,
  1.28178132e-05, 1.18772170e-06, 6.80701853e-08, 2.51153326e-09,
  6.09129266e-11, 9.83272734e-13, 1.06351409e-14, 4.29518058e-16,
  4.09564689e-16, 3.78174138e-16, 3.48299899e-16, 4.21300632e-16,
  3.43017040e-16, 3.03014509e-16, 3.35145278e-16, 3.15497080e-16,
  2.73228187e-16, 2.78029947e-16, 2.75895391e-16, 3.08789353e-16,
  3.75740413e-16, 3.72597634e-16, 3.72449592e-16, 3.75746569e-16,
  3.72474087e-16, 3.81198074e-16],
 [7.30145886e-03, 6.01265504e-04, 1.60616907e-04, 3.69829075e-05,
  3.74225685e-06, 2.10084173e-07, 7.02482999e-09, 1.44220810e-10,
  1.84691582e-12, 1.49012823e-14, 4.89841027e-16, 4.23756134e-16,
  4.12235030e-16, 3.77453446e-16, 3.48304422e-16, 4.35538037e-16,
  3.53534415e-16, 3.02488829e-16, 3.36171695e-16, 3.14339373e-16,
  2.74589973e-16, 2.80451408e-16, 2.78726748e-16, 3.09638987e-16,
  3.73131761e-16, 3.71094037e-16, 3.75822927e-16, 3.72297817e-16,
  3.73598188e-16, 3.80971670e-16],
 [4.92630887e-03, 2.68282080e-04, 1.11456744e-04, 1.56580538e-05,
  1.00089087e-06, 3.41530573e-08, 6.56307808e-10, 7.27374943e-12,
  4.70894338e-14, 5.64141820e-16, 4.91066488e-16, 4.25978349e-16,
  4.14685284e-16, 3.77570407e-16, 3.51600089e-16, 4.23190737e-16,
  3.50796659e-16, 3.05545171e-16, 3.35538947e-16, 3.15310136e-16,
  2.75518987e-16, 2.78736914e-16, 2.70894425e-16, 3.08954837e-16,
  3.72061791e-16, 3.71944306e-16, 3.77317031e-16, 3.79436671e-16,
  3.72043530e-16, 3.72383407e-16],
 [3.13359730e-03, 2.10849586e-04, 6.58913367e-05, 5.70307583e-06,
  2.23314662e-07, 4.45685709e-09, 4.73475143e-11, 2.73013884e-13,
  1.03341719e-15, 5.03990386e-16, 4.73743983e-16, 4.12024332e-16,
  3.99778812e-16, 3.66720734e-16, 3.39609424e-16, 4.20863059e-16,
  3.51120605e-16, 3.03008948e-16, 3.29614166e-16, 3.08194726e-16,
  2.72167823e-16, 2.75205672e-16, 2.69394823e-16, 3.03527431e-16,
  3.74435876e-16, 3.77246618e-16, 3.73845139e-16, 3.74425630e-16,
  3.74191983e-16, 3.79097932e-16],
 [1.91780986e-03, 1.96055185e-04, 3.58278141e-05, 1.97082183e-06,
  4.69128553e-08, 5.28632670e-10, 2.92692776e-12, 8.15092266e-15,
  5.38791036e-16, 5.08414451e-16, 4.75212198e-16, 4.12253851e-16,
  4.00503182e-16, 3.62764737e-16, 3.40133478e-16, 4.10994958e-16,
  3.44897599e-16, 3.03307149e-16, 3.30627097e-16, 3.10345814e-16,
  2.70987921e-16, 2.72485928e-16, 2.73077904e-16, 3.06442445e-16,
  3.69718127e-16, 3.78142428e-16, 3.78532913e-16, 3.70588348e-16,
  3.78348671e-16, 3.71512733e-16],
 [1.11414018e-03, 1.63798454e-04, 1.81808661e-05, 6.26720480e-07,
  8.86079993e-09, 5.54958573e-11, 1.59125575e-13, 6.38187294e-16,
  5.41836036e-16, 5.05262424e-16, 4.72713003e-16, 4.14014292e-16,
  4.10427787e-16, 3.67205445e-16, 3.36424707e-16, 4.21425147e-16,
  3.41760723e-16, 2.96813973e-16, 3.32506091e-16, 3.02046415e-16,
  2.68628407e-16, 2.74081944e-16, 2.68807375e-16, 3.03050591e-16,
  3.78070072e-16, 3.67743434e-16, 3.78630378e-16, 3.74399581e-16,
  3.73849251e-16, 3.71972420e-16],
 [5.49781599e-04, 1.15598891e-04, 7.69007906e-06, 1.60932396e-07,
  1.30592122e-09, 4.37768562e-12, 6.28510370e-15, 5.59944270e-16,
  5.12209367e-16, 4.84328024e-16, 4.51933218e-16, 3.94613286e-16,
  3.91482308e-16, 3.53145259e-16, 3.26762574e-16, 4.16104442e-16,
  3.22734964e-16, 2.88738176e-16, 3.28499594e-16, 3.00557157e-16,
  2.59927028e-16, 2.68569281e-16, 2.63061000e-16, 3.02214499e-16,
  3.69803310e-16, 3.69916149e-16, 3.70230753e-16, 3.71321656e-16,
  3.70296666e-16, 3.69656018e-16],
 [3.09254001e-04, 7.70208714e-05, 3.20791799e-06, 4.04219538e-08,
  1.82589811e-10, 3.13131975e-13, 7.69407674e-16, 5.60071599e-16,
  5.11029660e-16, 4.90452886e-16, 4.50428789e-16, 3.96017690e-16,
  3.82371521e-16, 3.52349543e-16, 3.27610779e-16, 4.09321427e-16,
  3.33249943e-16, 2.89911186e-16, 3.25591587e-16, 3.04168485e-16,
  2.64089908e-16, 2.70091876e-16, 2.62708308e-16, 2.98894613e-16,
  3.68290492e-16, 3.74944012e-16, 3.69509433e-16, 3.77444915e-16,
  3.73924788e-16, 3.69263011e-16],
 [2.52718872e-04, 4.63081956e-05, 1.20520483e-06, 9.08830732e-09,
  2.27991768e-11, 1.99509181e-14, 7.38617048e-16, 5.64131960e-16,
  5.11316669e-16, 4.87674206e-16, 4.52673483e-16, 3.93379516e-16,
  3.93354018e-16, 3.54293262e-16, 3.25448275e-16, 4.08820212e-16,
  3.23873423e-16, 2.91199487e-16, 3.26143937e-16, 3.02568783e-16,
  2.64437482e-16, 2.68972389e-16, 2.66568014e-16, 2.93463356e-16,
  3.71072618e-16, 3.66645253e-16, 3.74894556e-16, 3.75509877e-16,
  3.77924274e-16, 3.69681881e-16],
 [2.46784751e-04, 2.79959060e-05, 4.64848681e-07, 2.07191462e-09,
  2.79563410e-12, 1.43944999e-15, 7.39967761e-16, 5.63274944e-16,
  5.11783329e-16, 4.88512698e-16, 4.49219211e-16, 3.95689932e-16,
  3.87230351e-16, 3.52959077e-16, 3.29490540e-16, 4.11410405e-16,
  3.36667322e-16, 2.89475003e-16, 3.23356751e-16, 3.05318534e-16,
  2.68942558e-16, 2.69275682e-16, 2.67790977e-16, 2.95531904e-16,
  3.69720654e-16, 3.78621013e-16, 3.70336352e-16, 3.78011806e-16,
  3.72126716e-16, 3.73886241e-16],
 [2.26422079e-04, 1.43703937e-05, 1.41396824e-07, 3.46247019e-10,
  2.34445272e-13, 7.69800592e-16, 7.40373534e-16, 5.61622109e-16,
  5.10272193e-16, 4.87123732e-16, 4.54078779e-16, 3.94833050e-16,
  3.85710235e-16, 3.51862798e-16, 3.29504352e-16, 4.06702341e-16,
  3.28947338e-16, 2.88486728e-16, 3.25956701e-16, 3.04326388e-16,
  2.62183342e-16, 2.73351382e-16, 2.66062799e-16, 2.96961156e-16,
  3.69386774e-16, 3.78511288e-16, 3.74913236e-16, 3.74360749e-16,
  3.70458417e-16, 3.70550709e-16]])



fig = plt.figure(figsize=(4.8, 3.6))
ax = fig.add_subplot(1,1,1)
ax.set_facecolor("black")
levels = np.logspace(-11, -1, 11)
k_array = np.zeros(np.shape(levels))
print(np.shape(levels)[0])
print(levels)

cs = ax.contourf(sigma_ratio_array, eta_array*sigma_ratio_array, error_array,
                levels, cmap=plt.cm.gray, norm=mpl.colors.LogNorm(), locator = ticker.MaxNLocator(prune = 'lower'))
# cs2 = ax.contour(cs,
#                 levels, norm=mpl.colors.LogNorm())

# # #####Fitting
# from scipy.optimize import curve_fit
# def prop(x, k):
#     return k*x

# ydata = eta_array*sigma_ratio_array*0.5/np.sqrt(np.pi)
# for i in range(1, len(levels)):    
#     xdata = cs2.collections[i].get_paths()[0].vertices[:, 0]
#     ydata = cs2.collections[i].get_paths()[0].vertices[:, 1]
#     popt, pcov = curve_fit(prop, xdata, ydata)
#     k_array[i] = popt
#     fit_x = np.linspace(2, 12, 100)
#     fit_y = prop(fit_x, popt)
#     # ax.plot(fit_x, fit_y, linestyle='dashed')
#     # ax.scatter(xdata, ydata, marker='+')
# print(k_array)
# # #####Fitting


# ax.clabel(cs2, inline=True, fontsize=10, fmt='%2.1E', colors=[plt.cm.bone((20*i + 100)%291) for i in range(np.shape(levels)[0])])
cbar = fig.colorbar(cs)
cbar.ax.set_ylabel('Linear velocity % error')
cbar.ax.set_yscale('log')
# cbar.add_lines(cs)
# adding title and labels
ax.set_ylabel(r"$R_c/\sigma$")
ax.set_xlabel(r"$\Sigma/\sigma$")
ax.set_xlim((2., 12))
# ax.set_ylim((1, 80))
# ax.set_title(r"$R_c/\sigma$ vs. $\Sigma/\sigma$")
plt.savefig(f'img/rc_vs_sigmaratio_phi{phi}_ar{ar:.4f}.pdf', bbox_inches = 'tight', format='pdf')
plt.show()
