import matplotlib.pyplot as plt
import matplotlib.cm as cm
import matplotlib as mpl
import numpy as np

# boxsize=150
# phi_array = np.array([0.0005*4**j for j in range(5)])
# N_array = phi_array*(boxsize/0.5)**3/(4./3.*np.pi)

phi=0.32
ar=1./150.

sigma_ratio_array=np.array([[17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ]])

eta_array=np.array([[ 0.2       ,  0.26666667,  0.33333333,  0.4       ,  0.46666667,
   0.53333333,  0.6       ,  0.66666667,  0.73333333,  0.8       ,
   0.86666667,  0.93333333,  1.        ,  1.06666667,  1.13333333,
   1.2       ,  1.26666667,  1.33333333,  1.4       ,  1.46666667,
   1.53333333,  1.6       ,  1.66666667,  1.73333333,  1.76      ,
   1.76      ,  1.76      ,  1.76      ,  1.76      ,  1.76      ],
 [ 0.4       ,  0.53333333,  0.66666667,  0.8       ,  0.93333333,
   1.06666667,  1.2       ,  1.33333333,  1.46666667,  1.6       ,
   1.73333333,  1.86666667,  2.        ,  2.13333333,  2.26666667,
   2.4       ,  2.53333333,  2.66666667,  2.8       ,  2.93333333,
   3.06666667,  3.2       ,  3.33333333,  3.46666667,  3.52      ,
   3.52      ,  3.52      ,  3.52      ,  3.52      ,  3.52      ],
 [ 0.6       ,  0.8       ,  1.        ,  1.2       ,  1.4       ,
   1.6       ,  1.8       ,  2.        ,  2.2       ,  2.4       ,
   2.6       ,  2.8       ,  3.        ,  3.2       ,  3.4       ,
   3.6       ,  3.8       ,  4.        ,  4.2       ,  4.4       ,
   4.6       ,  4.8       ,  5.        ,  5.2       ,  5.28      ,
   5.28      ,  5.28      ,  5.28      ,  5.28      ,  5.28      ],
 [ 0.8       ,  1.06666667,  1.33333333,  1.6       ,  1.86666667,
   2.13333333,  2.4       ,  2.66666667,  2.93333333,  3.2       ,
   3.46666667,  3.73333333,  4.        ,  4.26666667,  4.53333333,
   4.8       ,  5.06666667,  5.33333333,  5.6       ,  5.86666667,
   6.13333333,  6.4       ,  6.66666667,  6.93333333,  7.04      ,
   7.04      ,  7.04      ,  7.04      ,  7.04      ,  7.04      ],
 [ 1.        ,  1.33333333,  1.66666667,  2.        ,  2.33333333,
   2.66666667,  3.        ,  3.33333333,  3.66666667,  4.        ,
   4.33333333,  4.66666667,  5.        ,  5.33333333,  5.66666667,
   6.        ,  6.33333333,  6.66666667,  7.        ,  7.33333333,
   7.66666667,  8.        ,  8.33333333,  8.66666667,  8.8       ,
   8.8       ,  8.8       ,  8.8       ,  8.8       ,  8.8       ],
 [ 1.2       ,  1.6       ,  2.        ,  2.4       ,  2.8       ,
   3.2       ,  3.6       ,  4.        ,  4.4       ,  4.8       ,
   5.2       ,  5.6       ,  6.        ,  6.4       ,  6.8       ,
   7.2       ,  7.6       ,  8.        ,  8.4       ,  8.8       ,
   9.2       ,  9.6       , 10.        , 10.4       , 10.56      ,
  10.56      , 10.56      , 10.56      , 10.56      , 10.56      ],
 [ 1.4       ,  1.86666667,  2.33333333,  2.8       ,  3.26666667,
   3.73333333,  4.2       ,  4.66666667,  5.13333333,  5.6       ,
   6.06666667,  6.53333333,  7.        ,  7.46666667,  7.93333333,
   8.4       ,  8.86666667,  9.33333333,  9.8       , 10.26666667,
  10.73333333, 11.2       , 11.66666667, 12.13333333, 12.32      ,
  12.32      , 12.32      , 12.32      , 12.32      , 12.32      ],
 [ 1.6       ,  2.13333333,  2.66666667,  3.2       ,  3.73333333,
   4.26666667,  4.8       ,  5.33333333,  5.86666667,  6.4       ,
   6.93333333,  7.46666667,  8.        ,  8.53333333,  9.06666667,
   9.6       , 10.13333333, 10.66666667, 11.2       , 11.73333333,
  12.26666667, 12.8       , 13.33333333, 13.86666667, 14.08      ,
  14.08      , 14.08      , 14.08      , 14.08      , 14.08      ],
 [ 1.8       ,  2.4       ,  3.        ,  3.6       ,  4.2       ,
   4.8       ,  5.4       ,  6.        ,  6.6       ,  7.2       ,
   7.8       ,  8.4       ,  9.        ,  9.6       , 10.2       ,
  10.8       , 11.4       , 12.        , 12.6       , 13.2       ,
  13.8       , 14.4       , 15.        , 15.6       , 15.84      ,
  15.84      , 15.84      , 15.84      , 15.84      , 15.84      ],
 [ 2.        ,  2.66666667,  3.33333333,  4.        ,  4.66666667,
   5.33333333,  6.        ,  6.66666667,  7.33333333,  8.        ,
   8.66666667,  9.33333333, 10.        , 10.66666667, 11.33333333,
  12.        , 12.66666667, 13.33333333, 14.        , 14.66666667,
  15.33333333, 16.        , 16.66666667, 17.33333333, 17.6       ,
  17.6       , 17.6       , 17.6       , 17.6       , 17.6       ],
 [ 2.2       ,  2.93333333,  3.66666667,  4.4       ,  5.13333333,
   5.86666667,  6.6       ,  7.33333333,  8.06666667,  8.8       ,
   9.53333333, 10.26666667, 11.        , 11.73333333, 12.46666667,
  13.2       , 13.93333333, 14.66666667, 15.4       , 16.13333333,
  16.86666667, 17.6       , 18.33333333, 19.06666667, 19.36      ,
  19.36      , 19.36      , 19.36      , 19.36      , 19.36      ],
 [ 2.4       ,  3.2       ,  4.        ,  4.8       ,  5.6       ,
   6.4       ,  7.2       ,  8.        ,  8.8       ,  9.6       ,
  10.4       , 11.2       , 12.        , 12.8       , 13.6       ,
  14.4       , 15.2       , 16.        , 16.8       , 17.6       ,
  18.4       , 19.2       , 20.        , 20.8       , 21.12      ,
  21.12      , 21.12      , 21.12      , 21.12      , 21.12      ],
 [ 2.6       ,  3.46666667,  4.33333333,  5.2       ,  6.06666667,
   6.93333333,  7.8       ,  8.66666667,  9.53333333, 10.4       ,
  11.26666667, 12.13333333, 13.        , 13.86666667, 14.73333333,
  15.6       , 16.46666667, 17.33333333, 18.2       , 19.06666667,
  19.93333333, 20.8       , 21.66666667, 22.53333333, 22.88      ,
  22.88      , 22.88      , 22.88      , 22.88      , 22.88      ],
 [ 2.8       ,  3.73333333,  4.66666667,  5.6       ,  6.53333333,
   7.46666667,  8.4       ,  9.33333333, 10.26666667, 11.2       ,
  12.13333333, 13.06666667, 14.        , 14.93333333, 15.86666667,
  16.8       , 17.73333333, 18.66666667, 19.6       , 20.53333333,
  21.46666667, 22.4       , 23.33333333, 24.26666667, 24.64      ,
  24.64      , 24.64      , 24.64      , 24.64      , 24.64      ],
 [ 3.        ,  4.        ,  5.        ,  6.        ,  7.        ,
   8.        ,  9.        , 10.        , 11.        , 12.        ,
  13.        , 14.        , 15.        , 16.        , 17.        ,
  18.        , 19.        , 20.        , 21.        , 22.        ,
  23.        , 24.        , 25.        , 26.        , 26.4       ,
  26.4       , 26.4       , 26.4       , 26.4       , 26.4       ],
 [ 3.2       ,  4.26666667,  5.33333333,  6.4       ,  7.46666667,
   8.53333333,  9.6       , 10.66666667, 11.73333333, 12.8       ,
  13.86666667, 14.93333333, 16.        , 17.06666667, 18.13333333,
  19.2       , 20.26666667, 21.33333333, 22.4       , 23.46666667,
  24.53333333, 25.6       , 26.66666667, 27.73333333, 28.16      ,
  28.16      , 28.16      , 28.16      , 28.16      , 28.16      ],
 [ 3.4       ,  4.53333333,  5.66666667,  6.8       ,  7.93333333,
   9.06666667, 10.2       , 11.33333333, 12.46666667, 13.6       ,
  14.73333333, 15.86666667, 17.        , 18.13333333, 19.26666667,
  20.4       , 21.53333333, 22.66666667, 23.8       , 24.93333333,
  26.06666667, 27.2       , 28.33333333, 29.46666667, 29.92      ,
  29.92      , 29.92      , 29.92      , 29.92      , 29.92      ],
 [ 3.6       ,  4.8       ,  6.        ,  7.2       ,  8.4       ,
   9.6       , 10.8       , 12.        , 13.2       , 14.4       ,
  15.6       , 16.8       , 18.        , 19.2       , 20.4       ,
  21.6       , 22.8       , 24.        , 25.2       , 26.4       ,
  27.6       , 28.8       , 30.        , 31.2       , 31.68      ,
  31.68      , 31.68      , 31.68      , 31.68      , 31.68      ],
 [ 3.8       ,  5.06666667,  6.33333333,  7.6       ,  8.86666667,
  10.13333333, 11.4       , 12.66666667, 13.93333333, 15.2       ,
  16.46666667, 17.73333333, 19.        , 20.26666667, 21.53333333,
  22.8       , 24.06666667, 25.33333333, 26.6       , 27.86666667,
  29.13333333, 30.4       , 31.66666667, 32.93333333, 33.44      ,
  33.44      , 33.44      , 33.44      , 33.44      , 33.44      ],
 [ 4.        ,  5.33333333,  6.66666667,  8.        ,  9.33333333,
  10.66666667, 12.        , 13.33333333, 14.66666667, 16.        ,
  17.33333333, 18.66666667, 20.        , 21.33333333, 22.66666667,
  24.        , 25.33333333, 26.66666667, 28.        , 29.33333333,
  30.66666667, 32.        , 33.33333333, 34.66666667, 35.2       ,
  35.2       , 35.2       , 35.2       , 35.2       , 35.2       ],
 [ 4.2       ,  5.6       ,  7.        ,  8.4       ,  9.8       ,
  11.2       , 12.6       , 14.        , 15.4       , 16.8       ,
  18.2       , 19.6       , 21.        , 22.4       , 23.8       ,
  25.2       , 26.6       , 28.        , 29.4       , 30.8       ,
  32.2       , 33.6       , 35.        , 36.4       , 36.96      ,
  36.96      , 36.96      , 36.96      , 36.96      , 36.96      ],
 [ 4.4       ,  5.86666667,  7.33333333,  8.8       , 10.26666667,
  11.73333333, 13.2       , 14.66666667, 16.13333333, 17.6       ,
  19.06666667, 20.53333333, 22.        , 23.46666667, 24.93333333,
  26.4       , 27.86666667, 29.33333333, 30.8       , 32.26666667,
  33.73333333, 35.2       , 36.66666667, 38.13333333, 38.72      ,
  38.72      , 38.72      , 38.72      , 38.72      , 38.72      ],
 [ 4.6       ,  6.13333333,  7.66666667,  9.2       , 10.73333333,
  12.26666667, 13.8       , 15.33333333, 16.86666667, 18.4       ,
  19.93333333, 21.46666667, 23.        , 24.53333333, 26.06666667,
  27.6       , 29.13333333, 30.66666667, 32.2       , 33.73333333,
  35.26666667, 36.8       , 38.33333333, 39.86666667, 40.48      ,
  40.48      , 40.48      , 40.48      , 40.48      , 40.48      ]])

error_array=np.array([[1.89979346e-01, 1.56551062e-01, 1.32626942e-01, 1.14267493e-01,
  9.96569790e-02, 8.76782908e-02, 7.76459243e-02, 6.91271778e-02,
  6.18252418e-02, 5.55182684e-02, 5.00385302e-02, 4.52512737e-02,
  4.10408691e-02, 3.73096325e-02, 3.39783713e-02, 3.09810605e-02,
  2.82646616e-02, 2.57872648e-02, 2.35148822e-02, 2.14218726e-02,
  1.94884589e-02, 1.76995862e-02, 1.60435023e-02, 1.45109190e-02,
  1.39306750e-02, 1.39306750e-02, 1.39306750e-02, 1.39306750e-02,
  1.39306750e-02, 1.39306750e-02],
 [1.50370735e-01, 1.14161898e-01, 8.95763685e-02, 7.19803112e-02,
  5.89788994e-02, 4.90391779e-02, 4.11806329e-02, 3.47710165e-02,
  2.93863637e-02, 2.47625380e-02, 2.07393706e-02, 1.72237687e-02,
  1.41603690e-02, 1.15137419e-02, 9.25606335e-03, 7.35864030e-03,
  5.78671295e-03, 4.50241311e-03, 3.46692481e-03, 2.64230608e-03,
  1.99311848e-03, 1.48779025e-03, 1.09914710e-03, 8.04138366e-04,
  7.07900709e-04, 7.07900709e-04, 7.07900709e-04, 7.07900709e-04,
  7.07900709e-04, 7.07900709e-04],
 [1.22127639e-01, 8.72430095e-02, 6.52173416e-02, 5.02200170e-02,
  3.92377910e-02, 3.06016742e-02, 2.35039761e-02, 1.76156443e-02,
  1.28041961e-02, 8.98787562e-03, 6.07277913e-03, 3.93956145e-03,
  2.45034235e-03, 1.46321033e-03, 8.46152679e-04, 4.86755958e-04,
  2.93509031e-04, 1.93815897e-04, 1.37570991e-04, 9.96816812e-05,
  7.11211814e-05, 4.92213105e-05, 3.29159354e-05, 2.12786132e-05,
  1.77088999e-05, 1.77088999e-05, 1.77088999e-05, 1.77088999e-05,
  1.77088999e-05, 1.77088999e-05],
 [1.04034681e-01, 7.17375362e-02, 5.18210491e-02, 3.78343515e-02,
  2.71843109e-02, 1.88551406e-02, 1.24638841e-02, 7.77778424e-03,
  4.54083655e-03, 2.45649108e-03, 1.22071062e-03, 5.64803146e-04,
  2.76285668e-04, 1.78273937e-04, 1.33426699e-04, 9.53322236e-05,
  6.24969649e-05, 3.78028470e-05, 2.13051529e-05, 1.12752724e-05,
  5.63568149e-06, 2.67149336e-06, 1.20462404e-06, 5.17840543e-07,
  3.64660911e-07, 3.64660911e-07, 3.64660911e-07, 3.64660911e-07,
  3.64660911e-07, 3.64660911e-07],
 [8.83925762e-02, 5.86712092e-02, 3.98340377e-02, 2.61676133e-02,
  1.61076556e-02, 9.11795068e-03, 4.66469861e-03, 2.10861951e-03,
  8.24890563e-04, 3.14327863e-04, 1.90123845e-04, 1.40996848e-04,
  9.18594914e-05, 5.20925532e-05, 2.63407457e-05, 1.20786805e-05,
  5.07752217e-06, 1.97064341e-06, 7.09536866e-07, 2.37806614e-07,
  7.43720930e-08, 2.17424640e-08, 5.94947417e-09, 1.52523471e-09,
  8.69009395e-10, 8.69009395e-10, 8.69009396e-10, 8.69009395e-10,
  8.69009395e-10, 8.69009396e-10],
 [7.58015841e-02, 4.74998274e-02, 2.90159342e-02, 1.61745811e-02,
  7.92770778e-03, 3.29852157e-03, 1.10842355e-03, 3.33279064e-04,
  2.01193466e-04, 1.40723916e-04, 7.86149779e-05, 3.66383402e-05,
  1.47794491e-05, 5.26706264e-06, 1.67842214e-06, 4.81883153e-07,
  1.25269885e-07, 2.95880967e-08, 6.36534847e-09, 1.24941429e-09,
  2.24033717e-10, 3.67311382e-11, 5.51023740e-12, 7.56714185e-13,
  3.33687733e-13, 3.33687128e-13, 3.33687960e-13, 3.33686470e-13,
  3.33687303e-13, 3.33687361e-13],
 [6.50697092e-02, 3.72364278e-02, 1.93530114e-02, 8.49825656e-03,
  2.95389501e-03, 7.45556924e-04, 2.48502044e-04, 1.79122195e-04,
  9.62246349e-05, 3.98084367e-05, 1.35412032e-05, 3.91113169e-06,
  9.75660891e-07, 2.12299265e-07, 4.05466576e-08, 6.82521550e-09,
  1.01547953e-09, 1.33817387e-10, 1.56419279e-11, 1.62368738e-12,
  1.49801384e-13, 1.23024239e-14, 1.04521213e-15, 5.24683727e-16,
  5.96481114e-16, 5.92346981e-16, 5.97100723e-16, 5.98475625e-16,
  5.96347171e-16, 5.93635045e-16],
 [5.52113915e-02, 2.77447445e-02, 1.15906313e-02, 3.65032588e-03,
  7.51404565e-04, 2.50401997e-04, 1.66238845e-04, 7.17593393e-05,
  2.29187599e-05, 5.80962934e-06, 1.20736993e-06, 2.09352907e-07,
  3.06136036e-08, 3.80157414e-09, 4.02836699e-10, 3.65515328e-11,
  2.84707162e-12, 1.90704511e-13, 1.10148293e-14, 8.04791581e-16,
  5.19870846e-16, 5.06108094e-16, 4.93147835e-16, 5.13787212e-16,
  5.93474597e-16, 5.94124994e-16, 5.92703331e-16, 5.93360387e-16,
  5.94239873e-16, 5.94421016e-16],
 [4.62421100e-02, 1.97816480e-02, 6.33331314e-03, 1.28799323e-03,
  2.77090854e-04, 1.80662918e-04, 7.06584496e-05, 1.91310988e-05,
  3.92192156e-06, 6.32306165e-07, 8.17288438e-08, 8.56275504e-09,
  7.32151701e-10, 5.13239846e-11, 2.95915420e-12, 1.40656766e-13,
  5.54906424e-15, 6.25443684e-16, 6.05386310e-16, 5.66889189e-16,
  4.99477677e-16, 4.93305984e-16, 4.73532797e-16, 4.99729787e-16,
  5.90345362e-16, 5.90814717e-16, 5.87786117e-16, 5.86816717e-16,
  5.87905872e-16, 5.87553919e-16],
 [3.79490492e-02, 1.33213245e-02, 3.01865955e-03, 3.95187776e-04,
  2.22815735e-04, 8.75276662e-05, 2.13389000e-05, 3.68808527e-06,
  4.75271365e-07, 4.67510860e-08, 3.55530527e-09, 2.10651308e-10,
  9.77503531e-12, 3.56558341e-13, 1.02632552e-14, 7.66609010e-16,
  6.38478612e-16, 5.91865336e-16, 5.82982910e-16, 5.51908249e-16,
  5.00718161e-16, 4.87403199e-16, 4.78051146e-16, 4.98912005e-16,
  5.85582135e-16, 5.84531221e-16, 5.89785609e-16, 5.85436569e-16,
  5.83434387e-16, 5.82778526e-16],
 [3.00149947e-02, 8.24726440e-03, 1.17229872e-03, 2.80432577e-04,
  1.30313342e-04, 3.09648461e-05, 4.75844761e-06, 5.11488877e-07,
  3.97192626e-08, 2.26431318e-09, 9.56358644e-11, 3.01020661e-12,
  7.08871829e-14, 1.47390968e-15, 6.77874358e-16, 7.14628644e-16,
  6.17612374e-16, 5.67877654e-16, 5.71394844e-16, 5.36646402e-16,
  4.77453712e-16, 4.72135491e-16, 4.78010927e-16, 4.89559123e-16,
  5.72032657e-16, 5.76618861e-16, 5.74706159e-16, 5.70825767e-16,
  5.75344113e-16, 5.78412447e-16],
 [2.28667469e-02, 4.61463985e-03, 4.16126409e-04, 2.13853550e-04,
  5.71485324e-05, 8.42733523e-06, 7.96475654e-07, 5.08416246e-08,
  2.24599760e-09, 6.95791329e-11, 1.52362014e-12, 2.37043480e-14,
  8.63589212e-16, 7.61993512e-16, 6.85567369e-16, 7.13591751e-16,
  6.22516384e-16, 5.70069848e-16, 5.69076662e-16, 5.37750567e-16,
  4.76951566e-16, 4.71978534e-16, 4.66063166e-16, 4.90159430e-16,
  5.71200301e-16, 5.74251996e-16, 5.76229189e-16, 5.75488829e-16,
  5.76471445e-16, 5.77091526e-16],
 [1.69459471e-02, 2.33649103e-03, 3.09466356e-04, 1.26864575e-04,
  2.08448303e-05, 1.92245732e-06, 1.09907100e-07, 4.05097289e-09,
  9.81900279e-11, 1.58303913e-12, 1.71023450e-14, 8.78993921e-16,
  7.97574206e-16, 7.34557067e-16, 6.57454640e-16, 6.93843164e-16,
  6.03145571e-16, 5.47634343e-16, 5.55148408e-16, 5.27391684e-16,
  4.62800746e-16, 4.58206917e-16, 4.53926991e-16, 4.75974353e-16,
  5.62449782e-16, 5.69823942e-16, 5.68239756e-16, 5.67925982e-16,
  5.66782314e-16, 5.68081812e-16],
 [1.21159931e-02, 1.03233878e-03, 2.65994052e-04, 6.23732080e-05,
  6.40333651e-06, 3.62039987e-07, 1.21023466e-08, 2.46795075e-10,
  3.12274597e-12, 2.47766544e-14, 1.03411746e-15, 8.77768943e-16,
  7.98776916e-16, 7.34028428e-16, 6.56012171e-16, 6.94888393e-16,
  6.06553853e-16, 5.53939817e-16, 5.52357972e-16, 5.27263286e-16,
  4.68848180e-16, 4.60220937e-16, 4.55680205e-16, 4.76385419e-16,
  5.65290698e-16, 5.63439978e-16, 5.67210619e-16, 5.67104353e-16,
  5.62725286e-16, 5.67530764e-16],
 [8.27869829e-03, 4.57724161e-04, 1.87292555e-04, 2.63480724e-05,
  1.68531841e-06, 5.74407567e-08, 1.10153172e-09, 1.21922417e-11,
  7.89751484e-14, 1.16288029e-15, 1.02558094e-15, 8.73996920e-16,
  7.99796434e-16, 7.29996274e-16, 6.60046114e-16, 6.94415203e-16,
  5.98276904e-16, 5.51005454e-16, 5.54860795e-16, 5.27485445e-16,
  4.59649976e-16, 4.59754433e-16, 4.61510183e-16, 4.73873562e-16,
  5.73750129e-16, 5.66645534e-16, 5.67839105e-16, 5.65256889e-16,
  5.66163955e-16, 5.67981568e-16],
 [5.31058977e-03, 3.56656253e-04, 1.11762916e-04, 9.66268728e-06,
  3.76500046e-07, 7.44174770e-09, 7.80436843e-11, 4.43881687e-13,
  1.86009949e-15, 1.08190577e-15, 9.76989676e-16, 8.31257080e-16,
  7.62387653e-16, 7.04780159e-16, 6.26131466e-16, 6.60424110e-16,
  5.77430869e-16, 5.31731180e-16, 5.32008065e-16, 5.09262605e-16,
  4.48844456e-16, 4.44834138e-16, 4.43268635e-16, 4.77124599e-16,
  5.62212723e-16, 5.61564540e-16, 5.55942433e-16, 5.57903045e-16,
  5.56330144e-16, 5.62225001e-16],
 [3.21092827e-03, 3.29477295e-04, 5.96948087e-05, 3.24243164e-06,
  7.65907281e-08, 8.64288459e-10, 4.83770492e-12, 1.37414352e-14,
  1.23984235e-15, 1.08100682e-15, 9.78807287e-16, 8.33436686e-16,
  7.67002302e-16, 6.99657329e-16, 6.26353691e-16, 6.60539094e-16,
  5.94357485e-16, 5.23984996e-16, 5.30556022e-16, 5.11393773e-16,
  4.50817602e-16, 4.43349043e-16, 4.50103984e-16, 4.71453944e-16,
  5.60350968e-16, 5.63960282e-16, 5.58229226e-16, 5.56733764e-16,
  5.59654784e-16, 5.62790301e-16],
 [1.79880555e-03, 2.67513311e-04, 2.90472153e-05, 9.86937574e-07,
  1.38088399e-08, 8.59417682e-11, 2.45964851e-13, 1.46368309e-15,
  1.22752958e-15, 1.07415284e-15, 9.77028663e-16, 8.33481377e-16,
  7.65394679e-16, 7.00593189e-16, 6.23306132e-16, 6.61983615e-16,
  5.78555751e-16, 5.27480719e-16, 5.33103649e-16, 5.04248755e-16,
  4.49511019e-16, 4.46812801e-16, 4.38223631e-16, 4.69542729e-16,
  5.57588710e-16, 5.61186728e-16, 5.59338015e-16, 5.57823589e-16,
  5.60809450e-16, 5.55318658e-16],
 [9.39245748e-04, 1.94331731e-04, 1.31182313e-05, 2.77027600e-07,
  2.25849673e-09, 7.58299266e-12, 1.08911279e-14, 1.30442596e-15,
  1.13165871e-15, 9.89861177e-16, 9.01727116e-16, 7.76484131e-16,
  7.06275722e-16, 6.44382612e-16, 5.80881628e-16, 6.38578094e-16,
  5.41606491e-16, 4.95684450e-16, 5.08731342e-16, 4.86029150e-16,
  4.25799724e-16, 4.30951351e-16, 4.33923353e-16, 4.59486993e-16,
  5.49603206e-16, 5.50154280e-16, 5.53065916e-16, 5.47476050e-16,
  5.50119069e-16, 5.49274147e-16],
 [5.14256406e-04, 1.28693070e-04, 5.43123571e-06, 6.95812278e-08,
  3.20451763e-10, 5.60872161e-13, 1.66342803e-15, 1.30444919e-15,
  1.14122618e-15, 9.93216025e-16, 9.02264743e-16, 7.78485672e-16,
  7.06829402e-16, 6.48964751e-16, 5.80359016e-16, 6.37673098e-16,
  5.39905896e-16, 5.00836694e-16, 5.11793924e-16, 4.89721529e-16,
  4.23758145e-16, 4.28929146e-16, 4.29637740e-16, 4.54341318e-16,
  5.50227779e-16, 5.56424702e-16, 5.50512978e-16, 5.53155913e-16,
  5.51105466e-16, 5.53626948e-16],
 [4.09164968e-04, 7.88147388e-05, 2.07927886e-06, 1.57798678e-08,
  3.96907073e-11, 3.48030518e-14, 1.62991986e-15, 1.30504164e-15,
  1.13700318e-15, 9.96500241e-16, 8.98670900e-16, 7.73592183e-16,
  6.99990044e-16, 6.46131985e-16, 5.80772594e-16, 6.37327747e-16,
  5.47292097e-16, 4.95819791e-16, 5.08191707e-16, 4.80060228e-16,
  4.23809164e-16, 4.29418574e-16, 4.22086435e-16, 4.54888522e-16,
  5.47574360e-16, 5.49725388e-16, 5.53309677e-16, 5.48565822e-16,
  5.51321837e-16, 5.51614166e-16],
 [3.95875325e-04, 4.45857450e-05, 7.24390401e-07, 3.16579158e-09,
  4.20645210e-12, 2.64885568e-15, 1.63038504e-15, 1.30991007e-15,
  1.13372926e-15, 9.89361371e-16, 9.01234516e-16, 7.79060388e-16,
  7.03850810e-16, 6.42898366e-16, 5.79330013e-16, 6.37872182e-16,
  5.42581110e-16, 4.99116733e-16, 5.06327000e-16, 4.85857919e-16,
  4.22320814e-16, 4.29683684e-16, 4.32809063e-16, 4.62928678e-16,
  5.51482720e-16, 5.50776580e-16, 5.50853353e-16, 5.50836028e-16,
  5.53201988e-16, 5.52830983e-16],
 [3.63240827e-04, 2.42183874e-05, 2.43185436e-07, 6.06835186e-10,
  4.19164490e-13, 1.95227983e-15, 1.62904985e-15, 1.30700129e-15,
  1.13686928e-15, 9.91541204e-16, 8.88866536e-16, 7.73546075e-16,
  7.04750801e-16, 6.47243381e-16, 5.82898010e-16, 6.37637698e-16,
  5.44967788e-16, 4.96718667e-16, 5.11416238e-16, 4.83512011e-16,
  4.22501989e-16, 4.28591489e-16, 4.33262941e-16, 4.53467791e-16,
  5.50341064e-16, 5.51188971e-16, 5.48395818e-16, 5.52264407e-16,
  5.53837138e-16, 5.52467083e-16]])



fig = plt.figure()
ax = fig.add_subplot(1,1,1)
levels = np.logspace(-16, -2, 15)
k_array = np.zeros(np.shape(levels))
print(np.shape(levels)[0])
print(levels)

cs = ax.contourf(sigma_ratio_array, eta_array*sigma_ratio_array, error_array,
                levels, cmap=plt.cm.bone, norm=mpl.colors.LogNorm())
cs2 = ax.contour(cs,
                levels, norm=mpl.colors.LogNorm())

# #####Fitting
from scipy.optimize import curve_fit
def prop(x, k):
    return k*x

ydata = eta_array*sigma_ratio_array*0.5/np.sqrt(np.pi)
for i in range(1, len(levels)):    
    xdata = cs2.collections[i].get_paths()[0].vertices[:, 0]
    ydata = cs2.collections[i].get_paths()[0].vertices[:, 1]
    popt, pcov = curve_fit(prop, xdata, ydata)
    k_array[i] = popt
    fit_x = np.linspace(2, 12, 100)
    fit_y = prop(fit_x, popt)
    # ax.plot(fit_x, fit_y, linestyle='dashed')
    # ax.scatter(xdata, ydata, marker='+')
print(k_array)
# #####Fitting


ax.clabel(cs2, inline=True, fontsize=10, fmt='%2.1E', colors=[plt.cm.bone((20*i + 100)%291) for i in range(np.shape(levels)[0])])
cbar = fig.colorbar(cs)
cbar.ax.set_ylabel('Linear velocity % error')
cbar.ax.set_yscale('log')
# cbar.add_lines(cs)
# adding title and labels
ax.set_ylabel(r"$R_c/\sigma$")
ax.set_xlabel(r"$\Sigma/\sigma$")
ax.set_xlim((2., 12))
# ax.set_ylim((1, 20))
# ax.set_title(r"$R_c/\sigma$ vs. $\Sigma/\sigma$")
plt.savefig(f'img/rc_vs_sigmaratio_phi{phi}_ar{ar:.4f}.pdf', bbox_inches = 'tight', format='pdf')
plt.show()
