import matplotlib.pyplot as plt
import matplotlib.cm as cm
import matplotlib as mpl
import numpy as np

# boxsize=150
# phi_array = np.array([0.0005*4**j for j in range(5)])
# N_array = phi_array*(boxsize/0.5)**3/(4./3.*np.pi)

phi=0.04
ar=1./150.


sigma_ratio_array=np.array([[17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  2.0141521 ,
   2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ,  2.0141521 ]])

eta_array=np.array([[ 0.2       ,  0.26666667,  0.33333333,  0.4       ,  0.46666667,
   0.53333333,  0.6       ,  0.66666667,  0.73333333,  0.8       ,
   0.86666667,  0.93333333,  1.        ,  1.06666667,  1.13333333,
   1.2       ,  1.26666667,  1.33333333,  1.4       ,  1.46666667,
   1.53333333,  1.6       ,  1.66666667,  1.73333333,  1.76      ,
   1.76      ,  1.76      ,  1.76      ,  1.76      ,  1.76      ],
 [ 0.4       ,  0.53333333,  0.66666667,  0.8       ,  0.93333333,
   1.06666667,  1.2       ,  1.33333333,  1.46666667,  1.6       ,
   1.73333333,  1.86666667,  2.        ,  2.13333333,  2.26666667,
   2.4       ,  2.53333333,  2.66666667,  2.8       ,  2.93333333,
   3.06666667,  3.2       ,  3.33333333,  3.46666667,  3.52      ,
   3.52      ,  3.52      ,  3.52      ,  3.52      ,  3.52      ],
 [ 0.6       ,  0.8       ,  1.        ,  1.2       ,  1.4       ,
   1.6       ,  1.8       ,  2.        ,  2.2       ,  2.4       ,
   2.6       ,  2.8       ,  3.        ,  3.2       ,  3.4       ,
   3.6       ,  3.8       ,  4.        ,  4.2       ,  4.4       ,
   4.6       ,  4.8       ,  5.        ,  5.2       ,  5.28      ,
   5.28      ,  5.28      ,  5.28      ,  5.28      ,  5.28      ],
 [ 0.8       ,  1.06666667,  1.33333333,  1.6       ,  1.86666667,
   2.13333333,  2.4       ,  2.66666667,  2.93333333,  3.2       ,
   3.46666667,  3.73333333,  4.        ,  4.26666667,  4.53333333,
   4.8       ,  5.06666667,  5.33333333,  5.6       ,  5.86666667,
   6.13333333,  6.4       ,  6.66666667,  6.93333333,  7.04      ,
   7.04      ,  7.04      ,  7.04      ,  7.04      ,  7.04      ],
 [ 1.        ,  1.33333333,  1.66666667,  2.        ,  2.33333333,
   2.66666667,  3.        ,  3.33333333,  3.66666667,  4.        ,
   4.33333333,  4.66666667,  5.        ,  5.33333333,  5.66666667,
   6.        ,  6.33333333,  6.66666667,  7.        ,  7.33333333,
   7.66666667,  8.        ,  8.33333333,  8.66666667,  8.8       ,
   8.8       ,  8.8       ,  8.8       ,  8.8       ,  8.8       ],
 [ 1.2       ,  1.6       ,  2.        ,  2.4       ,  2.8       ,
   3.2       ,  3.6       ,  4.        ,  4.4       ,  4.8       ,
   5.2       ,  5.6       ,  6.        ,  6.4       ,  6.8       ,
   7.2       ,  7.6       ,  8.        ,  8.4       ,  8.8       ,
   9.2       ,  9.6       , 10.        , 10.4       , 10.56      ,
  10.56      , 10.56      , 10.56      , 10.56      , 10.56      ],
 [ 1.4       ,  1.86666667,  2.33333333,  2.8       ,  3.26666667,
   3.73333333,  4.2       ,  4.66666667,  5.13333333,  5.6       ,
   6.06666667,  6.53333333,  7.        ,  7.46666667,  7.93333333,
   8.4       ,  8.86666667,  9.33333333,  9.8       , 10.26666667,
  10.73333333, 11.2       , 11.66666667, 12.13333333, 12.32      ,
  12.32      , 12.32      , 12.32      , 12.32      , 12.32      ],
 [ 1.6       ,  2.13333333,  2.66666667,  3.2       ,  3.73333333,
   4.26666667,  4.8       ,  5.33333333,  5.86666667,  6.4       ,
   6.93333333,  7.46666667,  8.        ,  8.53333333,  9.06666667,
   9.6       , 10.13333333, 10.66666667, 11.2       , 11.73333333,
  12.26666667, 12.8       , 13.33333333, 13.86666667, 14.08      ,
  14.08      , 14.08      , 14.08      , 14.08      , 14.08      ],
 [ 1.8       ,  2.4       ,  3.        ,  3.6       ,  4.2       ,
   4.8       ,  5.4       ,  6.        ,  6.6       ,  7.2       ,
   7.8       ,  8.4       ,  9.        ,  9.6       , 10.2       ,
  10.8       , 11.4       , 12.        , 12.6       , 13.2       ,
  13.8       , 14.4       , 15.        , 15.6       , 15.84      ,
  15.84      , 15.84      , 15.84      , 15.84      , 15.84      ],
 [ 2.        ,  2.66666667,  3.33333333,  4.        ,  4.66666667,
   5.33333333,  6.        ,  6.66666667,  7.33333333,  8.        ,
   8.66666667,  9.33333333, 10.        , 10.66666667, 11.33333333,
  12.        , 12.66666667, 13.33333333, 14.        , 14.66666667,
  15.33333333, 16.        , 16.66666667, 17.33333333, 17.6       ,
  17.6       , 17.6       , 17.6       , 17.6       , 17.6       ],
 [ 2.2       ,  2.93333333,  3.66666667,  4.4       ,  5.13333333,
   5.86666667,  6.6       ,  7.33333333,  8.06666667,  8.8       ,
   9.53333333, 10.26666667, 11.        , 11.73333333, 12.46666667,
  13.2       , 13.93333333, 14.66666667, 15.4       , 16.13333333,
  16.86666667, 17.6       , 18.33333333, 19.06666667, 19.36      ,
  19.36      , 19.36      , 19.36      , 19.36      , 19.36      ],
 [ 2.4       ,  3.2       ,  4.        ,  4.8       ,  5.6       ,
   6.4       ,  7.2       ,  8.        ,  8.8       ,  9.6       ,
  10.4       , 11.2       , 12.        , 12.8       , 13.6       ,
  14.4       , 15.2       , 16.        , 16.8       , 17.6       ,
  18.4       , 19.2       , 20.        , 20.8       , 21.12      ,
  21.12      , 21.12      , 21.12      , 21.12      , 21.12      ],
 [ 2.6       ,  3.46666667,  4.33333333,  5.2       ,  6.06666667,
   6.93333333,  7.8       ,  8.66666667,  9.53333333, 10.4       ,
  11.26666667, 12.13333333, 13.        , 13.86666667, 14.73333333,
  15.6       , 16.46666667, 17.33333333, 18.2       , 19.06666667,
  19.93333333, 20.8       , 21.66666667, 22.53333333, 22.88      ,
  22.88      , 22.88      , 22.88      , 22.88      , 22.88      ],
 [ 2.8       ,  3.73333333,  4.66666667,  5.6       ,  6.53333333,
   7.46666667,  8.4       ,  9.33333333, 10.26666667, 11.2       ,
  12.13333333, 13.06666667, 14.        , 14.93333333, 15.86666667,
  16.8       , 17.73333333, 18.66666667, 19.6       , 20.53333333,
  21.46666667, 22.4       , 23.33333333, 24.26666667, 24.64      ,
  24.64      , 24.64      , 24.64      , 24.64      , 24.64      ],
 [ 3.        ,  4.        ,  5.        ,  6.        ,  7.        ,
   8.        ,  9.        , 10.        , 11.        , 12.        ,
  13.        , 14.        , 15.        , 16.        , 17.        ,
  18.        , 19.        , 20.        , 21.        , 22.        ,
  23.        , 24.        , 25.        , 26.        , 26.4       ,
  26.4       , 26.4       , 26.4       , 26.4       , 26.4       ],
 [ 3.2       ,  4.26666667,  5.33333333,  6.4       ,  7.46666667,
   8.53333333,  9.6       , 10.66666667, 11.73333333, 12.8       ,
  13.86666667, 14.93333333, 16.        , 17.06666667, 18.13333333,
  19.2       , 20.26666667, 21.33333333, 22.4       , 23.46666667,
  24.53333333, 25.6       , 26.66666667, 27.73333333, 28.16      ,
  28.16      , 28.16      , 28.16      , 28.16      , 28.16      ],
 [ 3.4       ,  4.53333333,  5.66666667,  6.8       ,  7.93333333,
   9.06666667, 10.2       , 11.33333333, 12.46666667, 13.6       ,
  14.73333333, 15.86666667, 17.        , 18.13333333, 19.26666667,
  20.4       , 21.53333333, 22.66666667, 23.8       , 24.93333333,
  26.06666667, 27.2       , 28.33333333, 29.46666667, 29.92      ,
  29.92      , 29.92      , 29.92      , 29.92      , 29.92      ],
 [ 3.6       ,  4.8       ,  6.        ,  7.2       ,  8.4       ,
   9.6       , 10.8       , 12.        , 13.2       , 14.4       ,
  15.6       , 16.8       , 18.        , 19.2       , 20.4       ,
  21.6       , 22.8       , 24.        , 25.2       , 26.4       ,
  27.6       , 28.8       , 30.        , 31.2       , 31.68      ,
  31.68      , 31.68      , 31.68      , 31.68      , 31.68      ],
 [ 3.8       ,  5.06666667,  6.33333333,  7.6       ,  8.86666667,
  10.13333333, 11.4       , 12.66666667, 13.93333333, 15.2       ,
  16.46666667, 17.73333333, 19.        , 20.26666667, 21.53333333,
  22.8       , 24.06666667, 25.33333333, 26.6       , 27.86666667,
  29.13333333, 30.4       , 31.66666667, 32.93333333, 33.44      ,
  33.44      , 33.44      , 33.44      , 33.44      , 33.44      ],
 [ 4.        ,  5.33333333,  6.66666667,  8.        ,  9.33333333,
  10.66666667, 12.        , 13.33333333, 14.66666667, 16.        ,
  17.33333333, 18.66666667, 20.        , 21.33333333, 22.66666667,
  24.        , 25.33333333, 26.66666667, 28.        , 29.33333333,
  30.66666667, 32.        , 33.33333333, 34.66666667, 35.2       ,
  35.2       , 35.2       , 35.2       , 35.2       , 35.2       ],
 [ 4.2       ,  5.6       ,  7.        ,  8.4       ,  9.8       ,
  11.2       , 12.6       , 14.        , 15.4       , 16.8       ,
  18.2       , 19.6       , 21.        , 22.4       , 23.8       ,
  25.2       , 26.6       , 28.        , 29.4       , 30.8       ,
  32.2       , 33.6       , 35.        , 36.4       , 36.96      ,
  36.96      , 36.96      , 36.96      , 36.96      , 36.96      ],
 [ 4.4       ,  5.86666667,  7.33333333,  8.8       , 10.26666667,
  11.73333333, 13.2       , 14.66666667, 16.13333333, 17.6       ,
  19.06666667, 20.53333333, 22.        , 23.46666667, 24.93333333,
  26.4       , 27.86666667, 29.33333333, 30.8       , 32.26666667,
  33.73333333, 35.2       , 36.66666667, 38.13333333, 38.72      ,
  38.72      , 38.72      , 38.72      , 38.72      , 38.72      ],
 [ 4.6       ,  6.13333333,  7.66666667,  9.2       , 10.73333333,
  12.26666667, 13.8       , 15.33333333, 16.86666667, 18.4       ,
  19.93333333, 21.46666667, 23.        , 24.53333333, 26.06666667,
  27.6       , 29.13333333, 30.66666667, 32.2       , 33.73333333,
  35.26666667, 36.8       , 38.33333333, 39.86666667, 40.48      ,
  40.48      , 40.48      , 40.48      , 40.48      , 40.48      ]])

error_array=np.array([[7.58585346e-02, 5.91269297e-02, 4.71999810e-02, 3.83301886e-02,
  3.16711174e-02, 2.65821803e-02, 2.26012031e-02, 1.93718206e-02,
  1.66742422e-02, 1.43663209e-02, 1.23453946e-02, 1.05468769e-02,
  8.93057323e-03, 7.47611587e-03, 6.17434929e-03, 5.02377236e-03,
  4.02414649e-03, 3.17237115e-03, 2.46175730e-03, 1.88158224e-03,
  1.41804145e-03, 1.05543432e-03, 7.77505009e-04, 5.68672907e-04,
  5.01242423e-04, 5.01242423e-04, 5.01242423e-04, 5.01242423e-04,
  5.01242423e-04, 5.01242423e-04],
 [7.42755268e-02, 5.74807581e-02, 4.56251311e-02, 3.69071027e-02,
  3.04138833e-02, 2.54650293e-02, 2.15910775e-02, 1.84366739e-02,
  1.57877494e-02, 1.35059567e-02, 1.15072873e-02, 9.73860606e-03,
  8.16010575e-03, 6.75086285e-03, 5.50181275e-03, 4.40976385e-03,
  3.47224242e-03, 2.68425873e-03, 2.03714243e-03, 1.51825319e-03,
  1.11215157e-03, 8.02079287e-04, 5.71192129e-04, 4.03470951e-04,
  3.50773190e-04, 3.50773190e-04, 3.50773190e-04, 3.50773190e-04,
  3.50773190e-04, 3.50773190e-04],
 [5.96753764e-02, 4.35110543e-02, 3.28793584e-02, 2.55055962e-02,
  2.01449985e-02, 1.60442611e-02, 1.27497233e-02, 9.98988453e-03,
  7.63277560e-03, 5.64280327e-03, 4.01250780e-03, 2.73225853e-03,
  1.77576816e-03, 1.09856272e-03, 6.46765802e-04, 3.66176403e-04,
  2.07964405e-04, 1.29046412e-04, 9.14943939e-05, 6.92045052e-05,
  5.18123858e-05, 3.72504356e-05, 2.55619801e-05, 1.67739654e-05,
  1.40061880e-05, 1.40061880e-05, 1.40061880e-05, 1.40061880e-05,
  1.40061880e-05, 1.40061880e-05],
 [4.80275698e-02, 3.35146327e-02, 2.43019834e-02, 1.76838638e-02,
  1.26095310e-02, 8.67018215e-03, 5.70928779e-03, 3.59129266e-03,
  2.14768563e-03, 1.20931911e-03, 6.32550165e-04, 3.06080000e-04,
  1.44934308e-04, 8.24169290e-05, 6.00128699e-05, 4.47408009e-05,
  3.09206391e-05, 1.96328726e-05, 1.15524122e-05, 6.35179803e-06,
  3.28410257e-06, 1.60413480e-06, 7.42719360e-07, 3.26757822e-07,
  2.32038704e-07, 2.32038704e-07, 2.32038704e-07, 2.32038704e-07,
  2.32038704e-07, 2.32038704e-07],
 [4.24917389e-02, 2.89364129e-02, 2.01267189e-02, 1.36233329e-02,
  8.67624758e-03, 5.07077957e-03, 2.65315444e-03, 1.20696280e-03,
  4.60704560e-04, 1.64680674e-04, 1.03965200e-04, 8.07107166e-05,
  5.29608363e-05, 2.98704093e-05, 1.49445928e-05, 6.76213576e-06,
  2.79942427e-06, 1.06822706e-06, 3.77598098e-07, 1.24077557e-07,
  3.80002423e-08, 1.08687804e-08, 2.90766445e-09, 7.28465050e-10,
  4.11209831e-10, 4.11209832e-10, 4.11209832e-10, 4.11209831e-10,
  4.11209831e-10, 4.11209832e-10],
 [3.41513901e-02, 2.13514549e-02, 1.26078522e-02, 6.59220181e-03,
  2.93819886e-03, 1.07682936e-03, 3.21896645e-04, 1.26633728e-04,
  8.37956227e-05, 4.95944983e-05, 2.44617104e-05, 1.04499528e-05,
  3.95991890e-06, 1.34855493e-06, 4.15503465e-07, 1.16262630e-07,
  2.96123668e-08, 6.87532621e-09, 1.45679895e-09, 2.81966378e-10,
  4.98872949e-11, 8.07347273e-12, 1.19576141e-12, 1.62154206e-13,
  7.11516069e-14, 7.11507864e-14, 7.11505418e-14, 7.11509076e-14,
  7.11502500e-14, 7.11511337e-14],
 [3.10044415e-02, 1.82003632e-02, 9.70015372e-03, 4.37847416e-03,
  1.57554110e-03, 4.09399266e-04, 1.20936914e-04, 9.11988364e-05,
  5.14199802e-05, 2.19900418e-05, 7.67939577e-06, 2.26799274e-06,
  5.76938823e-07, 1.27757368e-07, 2.47841265e-08, 4.23061731e-09,
  6.37333682e-10, 8.49188872e-11, 1.00229505e-11, 1.04920518e-12,
  9.74984755e-14, 8.05765433e-15, 6.67719875e-16, 2.39031974e-16,
  2.95308796e-16, 2.95604028e-16, 2.95638557e-16, 2.88456640e-16,
  2.97302153e-16, 2.93102164e-16],
 [2.56973821e-02, 1.28923862e-02, 5.33241332e-03, 1.65563166e-03,
  3.36949841e-04, 1.16178265e-04, 7.58716467e-05, 3.23757456e-05,
  1.02756039e-05, 2.60078745e-06, 5.42532894e-07, 9.49138809e-08,
  1.40599291e-08, 1.77371711e-09, 1.91205311e-10, 1.76544792e-11,
  1.39825991e-12, 9.50840740e-14, 5.57082263e-15, 3.93116327e-16,
  2.14345717e-16, 2.09864988e-16, 2.22283221e-16, 2.30738904e-16,
  2.93143121e-16, 2.96138897e-16, 2.96537090e-16, 2.89812026e-16,
  2.91475418e-16, 2.91377733e-16],
 [2.13546649e-02, 8.96386709e-03, 2.73626458e-03, 4.99688895e-04,
  1.29079556e-04, 7.92737886e-05, 2.83932014e-05, 7.16575931e-06,
  1.38637439e-06, 2.13398120e-07, 2.66296131e-08, 2.71970905e-09,
  2.28428501e-10, 1.58198105e-11, 9.04852674e-13, 4.27970375e-14,
  1.72211376e-15, 2.60508689e-16, 2.52675249e-16, 2.35260168e-16,
  2.18401077e-16, 2.11574330e-16, 2.22071439e-16, 2.34611148e-16,
  2.94042024e-16, 2.91204052e-16, 2.92033598e-16, 2.95612032e-16,
  2.94004006e-16, 2.91945699e-16],
 [1.76391858e-02, 6.14758172e-03, 1.38321378e-03, 1.78041957e-04,
  1.02497346e-04, 4.00836572e-05, 9.66606143e-06, 1.64794412e-06,
  2.09256637e-07, 2.02911551e-08, 1.52343764e-09, 8.92836204e-11,
  4.10676829e-12, 1.48789451e-13, 4.27487723e-15, 3.38344756e-16,
  2.87598966e-16, 2.47117372e-16, 2.56922182e-16, 2.39226522e-16,
  2.19429788e-16, 2.06717432e-16, 2.21433386e-16, 2.34746983e-16,
  2.95165714e-16, 2.94984743e-16, 2.92139806e-16, 2.94883590e-16,
  2.87517245e-16, 2.90963748e-16],
 [1.37379916e-02, 3.60052645e-03, 4.62053065e-04, 1.30584057e-04,
  5.50212494e-05, 1.21187192e-05, 1.75640730e-06, 1.80843563e-07,
  1.36435785e-08, 7.64788580e-10, 3.20452560e-11, 1.00694605e-12,
  2.37779913e-14, 5.42500504e-16, 2.75394815e-16, 3.12297491e-16,
  2.87155735e-16, 2.50200021e-16, 2.55827129e-16, 2.36455627e-16,
  2.13940446e-16, 2.06280685e-16, 2.30755302e-16, 2.34963542e-16,
  2.95472743e-16, 2.93180724e-16, 2.94626024e-16, 2.93553776e-16,
  2.96918115e-16, 2.94859956e-16],
 [1.07563203e-02, 2.16438610e-03, 1.92031805e-04, 9.99986405e-05,
  2.69346104e-05, 3.98842685e-06, 3.78163114e-07, 2.42484546e-08,
  1.07785421e-09, 3.36370346e-11, 7.42442594e-13, 1.16551468e-14,
  3.46463386e-16, 2.82700976e-16, 2.68438111e-16, 3.10471615e-16,
  2.84695772e-16, 2.50188099e-16, 2.52255500e-16, 2.35306083e-16,
  2.18796131e-16, 2.04825818e-16, 2.18627753e-16, 2.34203515e-16,
  2.96379796e-16, 2.95650264e-16, 2.95353787e-16, 2.97629646e-16,
  2.95813032e-16, 2.92008684e-16],
 [7.75756819e-03, 1.00354377e-03, 1.45109443e-04, 5.53427570e-05,
  8.55666920e-06, 7.46743273e-07, 4.05602481e-08, 1.42919907e-09,
  3.33787654e-11, 5.22972473e-13, 5.54203014e-15, 3.08118610e-16,
  3.15320183e-16, 2.73142351e-16, 2.64907337e-16, 3.15440041e-16,
  2.82213870e-16, 2.41317972e-16, 2.53646187e-16, 2.33510471e-16,
  2.18420369e-16, 2.04544453e-16, 2.15924703e-16, 2.31868472e-16,
  2.95880697e-16, 2.95952624e-16, 2.92178028e-16, 2.95276053e-16,
  2.90589984e-16, 2.91527947e-16],
 [5.64478334e-03, 4.64175028e-04, 1.23942616e-04, 2.84598826e-05,
  2.88646646e-06, 1.62619100e-07, 5.46050654e-09, 1.12545001e-10,
  1.44513994e-12, 1.16793061e-14, 3.59116911e-16, 3.09760560e-16,
  3.14626403e-16, 2.73451960e-16, 2.63128571e-16, 3.12861326e-16,
  2.82114653e-16, 2.40038150e-16, 2.54468953e-16, 2.30661858e-16,
  2.14352002e-16, 2.02959626e-16, 2.11529599e-16, 2.31942624e-16,
  2.95358670e-16, 2.89647840e-16, 2.89658752e-16, 2.95588858e-16,
  2.87681882e-16, 2.96896053e-16],
 [3.97687156e-03, 2.19212600e-04, 9.00300818e-05, 1.30430547e-05,
  8.55977553e-07, 2.98723867e-08, 5.85202603e-10, 6.59991453e-12,
  4.34512109e-14, 4.16212977e-16, 3.55790996e-16, 3.08962028e-16,
  3.19722240e-16, 2.77813355e-16, 2.61686853e-16, 3.09253073e-16,
  2.79074632e-16, 2.39228537e-16, 2.54124044e-16, 2.32606611e-16,
  2.15012144e-16, 2.05224382e-16, 2.19031603e-16, 2.35221465e-16,
  2.91757139e-16, 2.88709318e-16, 2.93364266e-16, 2.87218677e-16,
  2.96871528e-16, 2.90575411e-16],
 [2.45292470e-03, 1.64262664e-04, 5.12650994e-05, 4.27076163e-06,
  1.59368197e-07, 3.01843238e-09, 3.04531826e-11, 1.67637514e-13,
  6.57254905e-16, 3.56493755e-16, 3.48730583e-16, 3.02021165e-16,
  3.10171482e-16, 2.69257946e-16, 2.59533863e-16, 3.08063291e-16,
  2.80969868e-16, 2.41841364e-16, 2.49038082e-16, 2.29610881e-16,
  2.11087258e-16, 2.00274193e-16, 2.18654994e-16, 2.27061926e-16,
  2.91556710e-16, 2.86469153e-16, 2.91068486e-16, 2.88585958e-16,
  2.86023283e-16, 2.86304820e-16],
 [1.53991222e-03, 1.52364951e-04, 2.89106086e-05, 1.62916253e-06,
  3.98006503e-08, 4.61615110e-10, 2.63584617e-12, 7.55776772e-15,
  3.69654183e-16, 3.57576499e-16, 3.42438848e-16, 3.01469330e-16,
  3.08779221e-16, 2.73125451e-16, 2.58750166e-16, 3.04340517e-16,
  2.82560531e-16, 2.38655092e-16, 2.49384141e-16, 2.31700163e-16,
  2.07718333e-16, 2.00366834e-16, 2.21713043e-16, 2.28590381e-16,
  2.92392499e-16, 2.94096845e-16, 2.88999853e-16, 2.88825762e-16,
  2.91180295e-16, 2.88336643e-16],
 [8.33550904e-04, 1.24329175e-04, 1.34642843e-05, 4.55483117e-07,
  6.34356059e-09, 3.93508839e-11, 1.12329088e-13, 4.40912116e-16,
  3.69467610e-16, 3.57221221e-16, 3.49586888e-16, 2.96786434e-16,
  3.08818198e-16, 2.68629535e-16, 2.60090066e-16, 3.10802303e-16,
  2.79740029e-16, 2.40867452e-16, 2.47985562e-16, 2.27766086e-16,
  2.09412267e-16, 1.99128356e-16, 2.19324942e-16, 2.29239669e-16,
  2.83588477e-16, 2.91752243e-16, 2.85263462e-16, 2.93829030e-16,
  2.92120563e-16, 2.86996884e-16],
 [4.40595724e-04, 9.04431714e-05, 6.16944006e-06, 1.31719915e-07,
  1.08637505e-09, 3.69231149e-12, 5.35231946e-15, 3.91428788e-16,
  3.59379964e-16, 3.49582019e-16, 3.39311077e-16, 2.91419585e-16,
  3.05375546e-16, 2.63663966e-16, 2.57574417e-16, 3.03436414e-16,
  2.74798263e-16, 2.34150166e-16, 2.45991607e-16, 2.29259418e-16,
  2.04026594e-16, 2.01137275e-16, 2.19536486e-16, 2.38271163e-16,
  2.93234843e-16, 2.93321463e-16, 2.90120793e-16, 2.90886329e-16,
  2.92554152e-16, 2.91458935e-16],
 [2.42381478e-04, 6.09617534e-05, 2.60303163e-06, 3.36559457e-08,
  1.55848666e-10, 2.73102946e-13, 5.43698524e-16, 3.92098272e-16,
  3.60498978e-16, 3.47218279e-16, 3.40862084e-16, 2.91626722e-16,
  3.06754608e-16, 2.64267601e-16, 2.55490036e-16, 3.06427118e-16,
  2.80609363e-16, 2.43564469e-16, 2.51673227e-16, 2.30021604e-16,
  2.08932104e-16, 2.01002512e-16, 2.14939057e-16, 2.31711694e-16,
  2.91405739e-16, 2.90468743e-16, 2.91031138e-16, 2.93120623e-16,
  2.85652392e-16, 2.89025810e-16],
 [1.88162948e-04, 3.70632160e-05, 9.78964876e-07, 7.39682158e-09,
  1.85140834e-11, 1.61516573e-14, 5.08391157e-16, 3.92764591e-16,
  3.60170938e-16, 3.48362843e-16, 3.40051908e-16, 2.92408509e-16,
  3.06065079e-16, 2.62899340e-16, 2.54207036e-16, 3.06548226e-16,
  2.74915315e-16, 2.29982828e-16, 2.41657000e-16, 2.30336331e-16,
  2.08863566e-16, 2.02122305e-16, 2.18913940e-16, 2.29336293e-16,
  2.91328914e-16, 2.90740177e-16, 2.92037688e-16, 2.91824584e-16,
  2.91843067e-16, 2.95196711e-16],
 [1.82482560e-04, 2.12259304e-05, 3.57118580e-07, 1.60978250e-09,
  2.18880186e-12, 1.07252770e-15, 5.07155262e-16, 3.93445938e-16,
  3.58383387e-16, 3.49751520e-16, 3.45590497e-16, 2.91088427e-16,
  3.04189313e-16, 2.60856182e-16, 2.55004842e-16, 3.07324016e-16,
  2.79438244e-16, 2.36048333e-16, 2.46675852e-16, 2.29405518e-16,
  2.04856811e-16, 2.01024368e-16, 2.14184002e-16, 2.33740570e-16,
  2.89473250e-16, 2.90022186e-16, 2.89790179e-16, 2.93072104e-16,
  2.94495252e-16, 2.90231096e-16],
 [1.69304811e-04, 1.13095788e-05, 1.13513062e-07, 2.81302611e-10,
  1.91877050e-13, 4.87551345e-16, 5.06048342e-16, 3.88531247e-16,
  3.57730877e-16, 3.48899345e-16, 3.42989030e-16, 2.90604754e-16,
  3.03667771e-16, 2.61352196e-16, 2.54204187e-16, 3.07135950e-16,
  2.76538617e-16, 2.37249716e-16, 2.45751184e-16, 2.31112085e-16,
  2.06448014e-16, 1.99894241e-16, 2.23009606e-16, 2.29266661e-16,
  2.89441991e-16, 2.94551104e-16, 2.93888213e-16, 2.93497422e-16,
  2.93397162e-16, 2.90155731e-16]])



fig = plt.figure()
ax = fig.add_subplot(1,1,1)
levels = np.logspace(-16, -2, 15)
k_array = np.zeros(np.shape(levels))
print(np.shape(levels)[0])
print(levels)

cs = ax.contourf(sigma_ratio_array, eta_array*sigma_ratio_array, error_array,
                levels, cmap=plt.cm.bone, norm=mpl.colors.LogNorm())
cs2 = ax.contour(cs,
                levels, norm=mpl.colors.LogNorm())

# #####Fitting
from scipy.optimize import curve_fit
def prop(x, k):
    return k*x

ydata = eta_array*sigma_ratio_array*0.5/np.sqrt(np.pi)
for i in range(1, len(levels)):    
    xdata = cs2.collections[i].get_paths()[0].vertices[:, 0]
    ydata = cs2.collections[i].get_paths()[0].vertices[:, 1]
    popt, pcov = curve_fit(prop, xdata, ydata)
    k_array[i] = popt
    fit_x = np.linspace(2, 12, 100)
    fit_y = prop(fit_x, popt)
    # ax.plot(fit_x, fit_y, linestyle='dashed')
    # ax.scatter(xdata, ydata, marker='+')
print(k_array)
# #####Fitting


ax.clabel(cs2, inline=True, fontsize=10, fmt='%2.1E', colors=[plt.cm.bone((20*i + 100)%291) for i in range(np.shape(levels)[0])])
cbar = fig.colorbar(cs)
cbar.ax.set_ylabel('Linear velocity % error')
cbar.ax.set_yscale('log')
# cbar.add_lines(cs)
# adding title and labels
ax.set_ylabel(r"$R_c/\sigma$")
ax.set_xlabel(r"$\Sigma/\sigma$")
ax.set_xlim((2., 12))
# ax.set_ylim((1, 20))
# ax.set_title(r"$R_c/\sigma$ vs. $\Sigma/\sigma$")
plt.savefig(f'img/rc_vs_sigmaratio_phi{phi}_ar{ar:.4f}.pdf', bbox_inches = 'tight', format='pdf')
plt.show()
