import matplotlib.pyplot as plt
import matplotlib.cm as cm
import numpy as np

boxsize=400
phi_array = np.array([0.00018*4**j for j in range(5)])
N_array = phi_array*(boxsize/1.0)**3/(4./3.*np.pi)

sigma_ratio_array = np.array([11.81635901, 10.12830772,  8.86226925,  7.87757267,  7.0898154 ,
  6.44528673,  5.9081795 ,  5.45370416,  5.06415386,  4.7265436 ,
  4.43113463,  4.17047965,  3.93878634,  3.73148179,  3.5449077 ,
  3.37610257,  3.22264337,  3.08252844,  2.95408975,  2.83592616,
  2.72685208,  2.62585756,  2.53207693,  2.44476393,  2.3632718 ,
  2.28703723,  2.21556731,  2.14842891,  2.08523982,  2.02566154,
  1.96939317,  1.91616633,  1.8657409 ,  1.81790139,  1.77245385,
  1.72922327,  1.68805129,  1.64879428,  1.61132168,  1.57551453,
  1.54126422,  1.50847136,  1.47704488,  1.4469011 ,  1.41796308,
  1.39015988,  1.36342604,  1.33770102,  1.31292878]
)

ptps_array = np.array([[2375276.39579878, 2744921.89449518, 3033947.11002747, 4883853.09369894,
                        3413096.36101872, 3234799.38362368, 2803404.86263316, 1076978.50742528,
                        2089411.62168733, 1733364.42884066, 1409186.87355238,  509300.75783953,
                        1070838.91467556,  399568.17577513,  793122.04562038,  694583.01024699,
                        621624.85956929,  233308.47537578,  503902.95745227,  445321.05218839,
                        313440.32096289,  332165.31928334,  318241.7317905 ,  117491.79373226,
                        280964.88449789,   97701.5965862 ,  207617.21124032,  194305.64348377,
                        101386.78690525,  160045.90698597,  155498.92253383,   55100.13899261,
                        103283.86349253,   38056.35800654,  104070.55908218,   39435.84089832,
                        92960.01941681,   34584.57387152,   86929.00681871,   85158.32791159,
                        41579.29973807,   26107.10005845,   64460.6588395 ,   62169.1471026 ,
                        33779.55511466,   17309.85906627,   23903.61921656,   17201.52139012,
                        45832.416685],
                        [3061602.21993994, 4393953.9194069 , 5600500.9902704 , 6341921.83293072,
                        6802258.34977212, 6915324.98884118, 6567164.17910448, 3503039.68307045,
                        6336296.0317506 , 5171603.19699107, 4243712.55405911, 2014589.28934447,
                        3739855.64157224, 1454695.49255989, 2766244.77242607, 2398970.62351427,
                        2138966.72351133,  872033.79685893, 1666595.96259553, 1504563.61500132,
                        1093412.19154594, 1138820.09955358, 1089424.95199102,  439442.08432973,
                        966733.81072407,  368507.48438701,  729520.37351443,  682971.04823638,
                        377198.03582696,  572705.48152036,  559214.74049386,  210711.09631451,
                        380833.28399811,  147679.234259  ,  381862.23799043,  152263.40239771,
                        345115.90403895,  133934.72459855,  322441.92894142,  317213.87020531,
                        160560.22088416,  101757.64123567,  242697.93616294,  235104.17359066,
                        130947.64189486,   68312.73869868,   93612.72704171,   67641.43716901,
                        175875.90196357],
                        [1457087.7186476 , 2281004.77630571, 2763833.93002952, 3386461.2353584 ,
                        4139086.39659715, 4861608.2871512 , 5436146.92409186, 4984368.27439342,
                        6308628.61198128, 6586664.11201356, 6741027.38508864, 4774045.71705075,
                        6765050.44231189, 4170465.63865379, 6471828.87297843, 6784566.16428324,
                        5859808.31743081, 2921083.67471171, 4597294.0500444 , 4223516.27910548,
                        3219622.55425975, 3302705.33170411, 3152219.62022641, 1507584.00096479,
                        2770699.33350334, 1270588.62935356, 2168084.03709142, 2049690.42468553,
                        1268669.06659424, 1765682.60648347, 1727379.93172604,  752355.09560157,
                        1247808.68540407,  541885.44312924, 1240843.06153767,  556364.82855838,
                        1135999.27301003,  493791.2231452 , 1067911.1189635 , 1048657.23829206,
                        578250.78971846,  380258.56337912,  826372.4029966 ,  801963.80255102,
                        478939.83880855,  259727.74950447,  349221.01246555,  256712.38149666,
                        618541.07915127],
                        [670988.14566769,  989094.68210726, 1361974.21416931, 1777310.68211058,
                        2223927.39776412, 2681279.86433649, 3196786.57673654, 3655749.87403062,
                        4326179.56550422, 4878586.90277417, 5401626.51526776, 5384408.30610722,
                        6327301.95636904, 5839384.09314244, 6979357.57807426, 7274257.1671345 ,
                        7478682.95775342, 5841622.506237  , 7681286.73728605, 7779900.40638368,
                        7121070.57996761, 7451732.15558833, 7491176.12384453, 4588084.56618838,
                        7230322.23266987, 4151647.45481263, 6526947.59552148, 6205694.88819581,
                        4165105.84445195, 5458267.87476362, 5112215.64876129, 2512926.05291205,
                        3633034.08255425, 1849116.49774318, 3673436.25071246, 1933748.15262737,
                        3408086.68342195, 1712772.12731257, 3140469.88575   , 3060457.65328283,
                        1884492.95445759, 1308731.06503073, 2332519.9224702 , 2282886.66383141,
                        1545255.74302112,  914549.06270568, 1177134.25471248,  908807.91170748,
                        1834346.84508642],
                        [225930.55035116,  338015.65391038,  480979.63784778,  657429.7130553 ,
                        859876.82699552, 1083088.32764147, 1335305.65213707, 1600185.82656513,
                        1902207.79576927, 2217868.00527336, 2543334.1255401 , 2843328.42395927,
                        3226927.30932013, 3502750.25970253, 3954665.22990701, 4295406.59023542,
                        4635017.01536109, 4724621.1243746 , 5326474.97510012, 5641991.3853551 ,
                        5926457.54828078, 6273606.21998139, 6548955.07866095, 5981492.84230124,
                        7136763.5210777 , 6142494.88852469, 7310969.30960898, 7520600.87042637,
                        6832994.92676452, 7690265.95070715, 7841531.23536778, 5818024.7787283 ,
                        7362431.90626282, 5070125.8792605 , 7555990.85274892, 5207584.4264046 ,
                        7522817.95004947, 4944308.1500991 , 7466510.72948356, 7361462.71913957,
                        5600502.67305577, 4276164.22754332, 6946615.10749913, 6921336.72979054,
                        5199718.91016019, 3335107.19381745, 4150067.0860216 , 3228881.83782974,
                        5704065.42163215]]
)

pop_index = [7, 11, 13, 17, 23, 25, 28, 31, 33, 35, 37, 40, 41, 44, 45, 46, 47]
sigma_ratio_array = np.delete(sigma_ratio_array, pop_index)
ptps_array = np.delete(ptps_array, pop_index, axis=1)

def plot_ptps_vs_npts(sigma_ratio_array, ptps_array):
    fig = plt.figure()
    ax = fig.add_subplot(1,1,1)
    
    # plot data
    for i, phi in enumerate(phi_array):
        ax.plot(sigma_ratio_array, ptps_array[i], marker='+', label=rf"$N$={int(N_array[i])},$\phi$={phi}")
    ax.legend()
    
    # adding title and labels
    ax.set_ylabel(r"PTPS")
    ax.set_xlabel(r"$\Sigma/\sigma$")
    ax.set_xlim((1, max(sigma_ratio_array)))
    ax.set_ylim((0, 1e7))
    ax.set_title(r"PTPS vs. $\Sigma/\sigma$")
    ax.set_ylabel('PTPS')
    plt.show()

plot_ptps_vs_npts(sigma_ratio_array, ptps_array)
