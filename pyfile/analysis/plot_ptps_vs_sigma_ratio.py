import matplotlib.pyplot as plt
import matplotlib.cm as cm
import numpy as np

boxsize=512
phi_array = np.array([0.0001*4**j for j in range(5)])
N_array = phi_array*(boxsize/1.0)**3/(4./3.*np.pi)

sigma_ratio_array = np.array([11.81635901,  7.87757267,  5.9081795 ,  4.7265436 ,  3.93878634,
  3.37610257,  2.95408975,  2.62585756,  2.3632718 ,  2.14842891,
  1.96939317,  1.68805129,  1.57551453,  1.47704488,  1.31292878]
)

ptps_array = np.array([[2912580.22834629, 6503180.6465344 , 3245718.6020985 , 1728896.46110612,
 1026648.05011536,  726638.56997529,  518316.35768729,  341283.79795503,
  286610.29650096,  196762.36472587,  156589.78203272,  
   93691.62373035,   85641.23485318,   64618.4877488 ,   
   46010.34279044],
                        [3470677.50780114, 6363163.07051542, 6912152.82141511, 5759192.45650501,
 3998604.12365138, 2567519.93912644, 1786918.13478236, 1228180.26113345,
 1038277.51647794,  721600.11545602,  582986.85364645, 
  354354.72970143,  324607.29894267,  246615.3721639 ,   
  177795.13345626],
                        [1416994.27058108, 3307305.11342156, 6000943.72044055, 7175283.48590642,
 7616177.73562242, 7464005.59083754, 5938230.42002019, 4359840.67850349,
 3531336.87298968, 2428965.87204418, 1999810.93985615,  
 1256396.47798972, 1150719.90928761,  876833.60307413,  
  645404.29402204],
                        [707695.88923063, 1758967.3486964 , 3107003.00740917, 5685795.91193303,
 6808764.13882743, 7770263.11142504, 8642910.10513187, 8357470.21429752,
 9298551.37389937, 7095810.2903198 , 6309166.80944963, 
 4279096.7248179 , 3796425.39152281, 2833228.08715896,  
 2112832.44532398],
                        [234544.09310521,  699429.33202666, 1398232.72757084, 2393956.20670167,
 3206169.3246306 , 4780453.57035819, 6191524.91441308, 6819437.69786709,
 7515286.49087625, 8167981.16578745, 8816760.77431209, 
 8547852.18899319, 9590409.61762592, 7965226.1115057 , 
 6883614.84569039]]
)


def plot_ptps_vs_npts(sigma_ratio_array, ptps_array):
    fig = plt.figure()
    ax = fig.add_subplot(1,1,1)
    
    # plot data
    for i, phi in enumerate(phi_array):
        ax.plot(sigma_ratio_array, ptps_array[i], marker='+', label=rf"$N$={int(N_array[i])}")
    ax.legend()
    
    # adding title and labels
    ax.set_ylabel(r"PTPS")
    ax.set_xlabel(r"$\Sigma/\sigma$")
    ax.set_xlim((1, max(sigma_ratio_array)))
    ax.set_ylim((0, 1e7))
    ax.set_title(r"PTPS vs. $\Sigma/\sigma$")
    ax.set_ylabel('PTPS')
    plt.show()

plot_ptps_vs_npts(sigma_ratio_array, ptps_array)
