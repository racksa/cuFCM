import matplotlib.pyplot as plt
import matplotlib.cm as cm
import numpy as np

boxsize=200
phi_array = np.array([0.0005*4**j for j in range(5)])
N_array = phi_array*(boxsize/0.5)**3/(4./3.*np.pi)

sigma_ratio_array = np.array(
[[17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ],
 [17.72453851, 13.29340388, 10.63472311,  8.86226925,  7.59623079,
   6.64670194,  5.9081795 ,  5.31736155,  4.83396505,  4.43113463,
   4.09027812,  3.79811539,  3.5449077 ,  3.32335097,  3.12785974,
   2.95408975,  2.79861134,  2.65868078,  2.53207693,  2.41698252,
   2.31189633,  2.21556731,  2.12694462,  2.04513906,  1.96939317,
   1.8990577 ]]

)

eta_array = np.array(
[[ 0.2       ,  0.26666667,  0.33333333,  0.4       ,  0.46666667,
   0.53333333,  0.6       ,  0.66666667,  0.73333333,  0.8       ,
   0.86666667,  0.93333333,  1.        ,  1.06666667,  1.13333333,
   1.2       ,  1.26666667,  1.33333333,  1.4       ,  1.46666667,
   1.53333333,  1.6       ,  1.66666667,  1.73333333,  1.8       ,
   1.86666667],
 [ 0.4       ,  0.53333333,  0.66666667,  0.8       ,  0.93333333,
   1.06666667,  1.2       ,  1.33333333,  1.46666667,  1.6       ,
   1.73333333,  1.86666667,  2.        ,  2.13333333,  2.26666667,
   2.4       ,  2.53333333,  2.66666667,  2.8       ,  2.93333333,
   3.06666667,  3.2       ,  3.33333333,  3.46666667,  3.6       ,
   3.73333333],
 [ 0.6       ,  0.8       ,  1.        ,  1.2       ,  1.4       ,
   1.6       ,  1.8       ,  2.        ,  2.2       ,  2.4       ,
   2.6       ,  2.8       ,  3.        ,  3.2       ,  3.4       ,
   3.6       ,  3.8       ,  4.        ,  4.2       ,  4.4       ,
   4.6       ,  4.8       ,  5.        ,  5.2       ,  5.4       ,
   5.6       ],
 [ 0.8       ,  1.06666667,  1.33333333,  1.6       ,  1.86666667,
   2.13333333,  2.4       ,  2.66666667,  2.93333333,  3.2       ,
   3.46666667,  3.73333333,  4.        ,  4.26666667,  4.53333333,
   4.8       ,  5.06666667,  5.33333333,  5.6       ,  5.86666667,
   6.13333333,  6.4       ,  6.66666667,  6.93333333,  7.2       ,
   7.46666667],
 [ 1.        ,  1.33333333,  1.66666667,  2.        ,  2.33333333,
   2.66666667,  3.        ,  3.33333333,  3.66666667,  4.        ,
   4.33333333,  4.66666667,  5.        ,  5.33333333,  5.66666667,
   6.        ,  6.33333333,  6.66666667,  7.        ,  7.33333333,
   7.66666667,  8.        ,  8.33333333,  8.66666667,  9.        ,
   9.33333333],
 [ 1.2       ,  1.6       ,  2.        ,  2.4       ,  2.8       ,
   3.2       ,  3.6       ,  4.        ,  4.4       ,  4.8       ,
   5.2       ,  5.6       ,  6.        ,  6.4       ,  6.8       ,
   7.2       ,  7.6       ,  8.        ,  8.4       ,  8.8       ,
   9.2       ,  9.6       , 10.        , 10.4       , 10.8       ,
  11.2       ],
 [ 1.4       ,  1.86666667,  2.33333333,  2.8       ,  3.26666667,
   3.73333333,  4.2       ,  4.66666667,  5.13333333,  5.6       ,
   6.06666667,  6.53333333,  7.        ,  7.46666667,  7.93333333,
   8.4       ,  8.86666667,  9.33333333,  9.8       , 10.26666667,
  10.73333333, 11.2       , 11.66666667, 12.13333333, 12.6       ,
  13.06666667],
 [ 1.6       ,  2.13333333,  2.66666667,  3.2       ,  3.73333333,
   4.26666667,  4.8       ,  5.33333333,  5.86666667,  6.4       ,
   6.93333333,  7.46666667,  8.        ,  8.53333333,  9.06666667,
   9.6       , 10.13333333, 10.66666667, 11.2       , 11.73333333,
  12.26666667, 12.8       , 13.33333333, 13.86666667, 14.4       ,
  14.93333333],
 [ 1.8       ,  2.4       ,  3.        ,  3.6       ,  4.2       ,
   4.8       ,  5.4       ,  6.        ,  6.6       ,  7.2       ,
   7.8       ,  8.4       ,  9.        ,  9.6       , 10.2       ,
  10.8       , 11.4       , 12.        , 12.6       , 13.2       ,
  13.8       , 14.4       , 15.        , 15.6       , 16.2       ,
  16.8       ],
 [ 2.        ,  2.66666667,  3.33333333,  4.        ,  4.66666667,
   5.33333333,  6.        ,  6.66666667,  7.33333333,  8.        ,
   8.66666667,  9.33333333, 10.        , 10.66666667, 11.33333333,
  12.        , 12.66666667, 13.33333333, 14.        , 14.66666667,
  15.33333333, 16.        , 16.66666667, 17.33333333, 18.        ,
  18.66666667]]
)

error_array = np.array(
[[2.46996510e-01, 1.96357718e-01, 1.61209942e-01, 1.35267643e-01,
  1.15296879e-01, 9.94405540e-02, 8.65429680e-02, 7.58001686e-02,
  6.66187409e-02, 5.85666376e-02, 5.13431866e-02, 4.47697081e-02,
  3.87631032e-02, 3.32990057e-02, 2.83799720e-02, 2.40124551e-02,
  2.01935929e-02, 1.69068038e-02, 1.41209819e-02, 1.17932145e-02,
  9.87263374e-03, 8.30435725e-03, 7.03286854e-03, 6.00450387e-03,
  5.16957214e-03, 4.48435269e-03],
 [2.39467276e-01, 1.88235281e-01, 1.52787970e-01, 1.26739757e-01,
  1.06792844e-01, 9.10367113e-02, 7.82787943e-02, 6.76963755e-02,
  5.86832894e-02, 5.07985286e-02, 4.37394355e-02, 3.73293002e-02,
  3.14892407e-02, 2.62018978e-02, 2.14772875e-02, 1.73280578e-02,
  1.37555551e-02, 1.07446789e-02, 8.26333553e-03, 6.26527174e-03,
  4.69431540e-03, 3.48909225e-03, 2.58691780e-03, 1.92674647e-03,
  1.45197867e-03, 1.11273408e-03],
 [1.77747915e-01, 1.28214351e-01, 9.66811506e-02, 7.49231333e-02,
  5.86367591e-02, 4.56089242e-02, 3.48262126e-02, 2.58960618e-02,
  1.86696730e-02, 1.30318613e-02, 8.81432708e-03, 5.79283670e-03,
  3.72219511e-03, 2.36637788e-03, 1.51683890e-03, 1.00052121e-03,
  6.87018403e-04, 4.88702242e-04, 3.53310733e-04, 2.54179826e-04,
  1.79277189e-04, 1.23676262e-04, 8.29662446e-05, 5.44860302e-05,
  3.54473504e-05, 2.35057197e-05],
 [1.51535551e-01, 1.05563778e-01, 7.67795091e-02, 5.64846276e-02,
  4.09691495e-02, 2.87919823e-02, 1.93724640e-02, 1.23585323e-02,
  7.41316796e-03, 4.16295843e-03, 2.21273640e-03, 1.17979587e-03,
  7.06740549e-04, 4.84923949e-04, 3.41815636e-04, 2.30090624e-04,
  1.45171223e-04, 8.59959014e-05, 4.82693561e-05, 2.64796565e-05,
  1.23666828e-05, 1.06527646e-05, 8.88861511e-06, 8.81103106e-06,
  8.96290495e-06, 9.28948665e-06],
 [1.25971676e-01, 8.40483485e-02, 5.69755138e-02, 3.71935170e-02,
  2.25973506e-02, 1.25001509e-02, 6.19663514e-03, 2.74355956e-03,
  1.16581713e-03, 6.07390002e-04, 3.95573910e-04, 2.52102237e-04,
  1.45043429e-04, 7.54707184e-05, 3.66859932e-05, 1.77452235e-05,
  1.11290686e-05, 9.46279311e-06, 8.86755872e-06, 9.01849960e-06,
  1.78903195e-07, 8.75766051e-06, 8.40894820e-06, 8.70517373e-06,
  8.95374562e-06, 9.27401341e-06],
 [1.07012714e-01, 6.72592703e-02, 4.07516716e-02, 2.24900112e-02,
  1.09544972e-02, 4.58568052e-03, 1.64166489e-03, 6.36285685e-04,
  3.83788330e-04, 2.37107621e-04, 1.24200281e-04, 5.61764691e-05,
  2.38153605e-05, 1.19297188e-05, 1.01695400e-05, 8.92440881e-06,
  9.27771251e-06, 9.20047217e-06, 8.83553147e-06, 9.01538166e-06,
  1.68017289e-07, 8.75158234e-06, 8.39922625e-06, 8.69855065e-06,
  8.93584294e-06, 9.27148200e-06],
 [9.27062711e-02, 5.37119956e-02, 2.80230343e-02, 1.23180269e-02,
  4.31101595e-03, 1.18966517e-03, 4.91415177e-04, 3.08977167e-04,
  1.53753126e-04, 6.11131769e-05, 2.22282265e-05, 1.24354690e-05,
  1.08927361e-05, 9.58694179e-06, 9.98483016e-06, 8.93853313e-06,
  9.29480386e-06, 9.17333207e-06, 8.82988828e-06, 9.02089568e-06,
  1.62366304e-07, 8.76140362e-06, 8.40441699e-06, 8.69238785e-06,
  8.95127268e-06, 9.27678771e-06],
 [7.74935354e-02, 3.90617689e-02, 1.62221120e-02, 5.12834526e-03,
  1.18499694e-03, 4.49082558e-04, 2.57427106e-04, 1.07538319e-04,
  3.54629769e-05, 1.36769998e-05, 1.12777683e-05, 1.14769944e-05,
  1.09167856e-05, 9.59005478e-06, 9.99581913e-06, 8.94656559e-06,
  9.28742512e-06, 9.17998033e-06, 8.83066519e-06, 9.00791658e-06,
  1.62724779e-07, 8.74318262e-06, 8.40042548e-06, 8.69258187e-06,
  8.94611877e-06, 9.27419766e-06],
 [6.64677553e-02, 2.90210977e-02, 9.50554966e-03, 2.05161507e-03,
  5.04623576e-04, 2.95055286e-04, 1.13690089e-04, 3.23113500e-05,
  1.32162030e-05, 1.11833527e-05, 1.12607932e-05, 1.14848575e-05,
  1.08950428e-05, 9.59414956e-06, 9.99794048e-06, 8.93727879e-06,
  9.29081048e-06, 9.18427196e-06, 8.82740337e-06, 9.02111266e-06,
  1.65340096e-07, 8.75813421e-06, 8.39869906e-06, 8.69943441e-06,
  8.94364447e-06, 9.27995872e-06],
 [5.30177124e-02, 1.83479421e-02, 4.07584065e-03, 6.31197822e-04,
  3.33802713e-04, 1.20349325e-04, 3.01656959e-05, 1.31102396e-05,
  1.21458080e-05, 1.12159876e-05, 1.12695052e-05, 1.14834308e-05,
  1.08952225e-05, 9.59401992e-06, 9.97744310e-06, 8.93690486e-06,
  9.28684142e-06, 9.17566925e-06, 8.83635364e-06, 9.00767506e-06,
  1.68381687e-07, 8.75948409e-06, 8.41173246e-06, 8.69555759e-06,
  8.94847408e-06, 9.26698044e-06]]
)

fig = plt.figure()
ax = fig.add_subplot(1,1,1)
levels = np.logspace(-6., -1, 6)
cs = ax.contour(sigma_ratio_array, eta_array*sigma_ratio_array*0.5/np.sqrt(np.pi), error_array,
                levels)
ax.clabel(cs, inline=True, fontsize=10)

# adding title and labels
ax.set_ylabel(r"$R_c/\sigma$")
ax.set_xlabel(r"$\Sigma/\sigma$")
# ax.set_xlim((1, max(sigma_ratio_array)))
# ax.set_ylim((2, 10))
ax.set_title(r"PTPS vs. $\Sigma/\sigma$")
plt.savefig('img/ptps_vs_sigmaratio_linear.eps', format='eps')
plt.show()
